<div class="navbar navbar-app navbar-absolute-top">
    <div class="navbar-brand navbar-brand-center">
        NRC开卡
    </div>
    <div class="btn-group btn-group-left">
        <div class="btn" ng-click="go('back')">
            <i class="icon-maoc icon-back"></i>
        </div>
    </div>
</div>
<div class="scrollable-content">
    <form name="myForm" novalidate>
       <div class="damage-draft-detail">
           <div class="section-1">
               <div class="header">基础信息</div>
               <div class="item">
                   <div class="title" style="width: 35%!important;">
                       <span class="">来源</span>
                   </div>
                   <div class="right" style="width: 63% !important;">
                       <label><input  type="radio" name="way" value="1" ng-model="info.basic.source" ng-checked="info.basic.source==1">飞机</label>
                       <label><input    type="radio" name="way" value="2" ng-model="info.basic.source" ng-checked="info.basic.source==2">发动机</label>
                   </div>

               </div>
<!--               <flight-no info="info.basic.flightNoInfo"></flight-no>-->
               <div class="item" ng-if="info.basic.source==1">
                   <div class="title">
                       <span>飞机号</span>
                       <span class="red">*</span>
                   </div>
                   <input class="right" ng-model="info.basic.flightNoInfo.label" type="text" readonly placeholder="">
               </div>
               <div class="item" ng-if="info.basic.source==2">
                   <div class="title">
                       <span class="">发动机</span>
                       <span class="red">*</span>
                   </div>
                   <div class="right">
                       <div class="check-method">
                          <span ng-repeat="item in info.basic.engs" ng-if="item.id == info.basic.eng">
                              {{item.sn}}
                          </span>
                           <select ng-model="info.basic.eng" ng-required="info.basic.source==2" >
                               <option ng-repeat="item in info.basic.engs" value="{{item.id}}" ng-selected="item.id== info.basic.eng">{{item.sn}}</option>
                               <!--                               <option value="id">sn</option>-->
                           </select>
                       </div>
                       <img class="triangle" style="width: 10px" src="dist/images/oil/Shape1@2x.png">
                   </div>
               </div>
               <div class="item" ng-if="info.basic.source==1">
                   <span class="title">机型</span>
                   <input class="right" ng-model="info.basic.flightNoInfo.pid" type="text" readonly placeholder="">
               </div>
               <div class="item" ng-if="info.basic.source==2">
                   <span class="title">件号</span>
                   <input class="right" ng-repeat="item in info.basic.engs" ng-if="item.id== info.basic.eng" value="{{item.pn}}" type="text" readonly placeholder="">
               </div>
               <div class="item">
                   <div class="title">
                       <span class="">Skill</span>
                       <span class="red">*</span>
                   </div>
                   <div class="right">
                       <div class="check-method">
                          <span ng-repeat="item in info.basic.skills" ng-if="item.value == info.basic.skill">
                              {{item.name}}
                          </span>
                           <select ng-model="info.basic.skill"  required>
                               <option ng-repeat="item in info.basic.skills" value="{{item.value}}" ng-selected="item.value== info.basic.skill">{{item.name}}</option>
<!--                               <option value="1">ME</option>-->
<!--                               <option value="2">AV</option>-->
<!--                               <option value="3">STR</option>-->
                           </select>
                       </div>
                       <img class="triangle" style="width: 10px" src="dist/images/oil/Shape1@2x.png">
                   </div>
               </div>
               <div class="item">
                   <span class="title">STA/ZONE</span>
                   <input class="right" ng-model="info.basic.zone" type="text" placeholder="请填写">
               </div>
               <div class="item">
                   <div class="title">
                       <span class="">ITEM CAT</span>
                       <span class="red">*</span>
                   </div>
                   <div class="right">
                       <div class="check-method">
                          <span ng-repeat="item in info.basic.itemcats" ng-if="item.value == info.basic.itemcat">
                              {{item.name}}
                          </span>
                           <select ng-model="info.basic.itemcat" required>
                               <option ng-repeat="item in info.basic.itemcats" value="{{item.value}}" ng-selected="item.value== info.basic.itemcat">{{item.name}}</option>

<!--                               <option value="">请选择</option>-->
<!--                               <option value="1">STRUCTURE</option>-->
<!--                               <option value="2">MINOR DEFECT</option>-->
<!--                               <option value="3">CHK/SVC</option>-->
                           </select>
                       </div>
                       <img class="triangle" style="width: 10px" src="dist/images/oil/Shape1@2x.png">
                   </div>
               </div>

               <div class="item">
                   <div class="title" style="width: 35%!important;">
                       <span class="">外观是否可见</span>
                       <span class="red">*</span>
                   </div>
                   <div class="right" style="width: 63% !important;">
                       <label><input  type="radio" name="seen" value="y" ng-model="info.basic.cansee" ng-checked="info.basic.cansee=='y'">YES</label>
                       <label><input  type="radio" name="seen" value="n" ng-model="info.basic.cansee" ng-checked="info.basic.cansee=='n'">NO</label>
                   </div>

               </div>


               <div class="item" style="overflow: hidden;padding-right: 0">
                   <div class="title" style="width: 35%!important;">
                       <span class="">报告日期</span>
                       <span class="red">*</span>
                   </div>
                   <div class="right" style="width: 63%!important;overflow: hidden;text-align: right">
                       <div class="check-method">
<!--                           <input ng-if="!android" class="fount-date"-->
<!--                                  ng-model="info.toolInfos.drDate"-->
<!--                                  type="date">-->
<!--                           <input ng-if="android" class="fount-date"-->
<!--                                  ng-model="info.toolInfos.drDate"-->
<!--                                  type="date">-->

                           <input style="padding-left:0;width: 12em" ng-if="!android"   name="dateFound" type="datetime-local" class="fount-date" ng-model="info.basic.drDate" step="1800">
                           <input style="padding-left:0;width: 12em" ng-if="android"   name="dateFound" type="datetime-local" class="fount-date"  ng-model="info.basic.drDate" step="1800">
<!--                           <input type="text" class="form-control isBeginDateChanged"  value="{{startDate | date:'MM/dd HH:mm'}}">-->
                       </div>
                       <img class="triangle" style="width: 10px" src="dist/images/oil/Shape1@2x.png">

                   </div>
               </div>
               <div class="item">
                   <div class="title">
                       <span class="">报告者</span>
                       <span class="red">*</span>
                   </div>
                   <div class="right ipt">
                       <select-person is-required="false" show-title="false" person-info="info.mech" is-auto-loginercode="true"></select-person>
                   </div>

               </div>
           </div>
           <div class="section-2">
               <div class="header">工卡来源</div>
               <div class="item">
                   <div class="title">
                       <span class="">工卡类型</span>
                       <span class="red">*</span>
                   </div>
                   <div class="right">
                       <div class="check-method" style="position: relative;">
                           <div ng-show="createMark == 'SYSTEM'" style="width: 100%;height: 100%;position: absolute;top: 0;left: 0;opacity: 0;z-index: 9"></div>
                           <span ng-repeat="item in info.cardList" ng-if="item.value == info.card.cardType">
                              {{item.name}}
                          </span>
                           <select ng-model="info.card.cardType" required>
                               <option value="">请选择</option>
                               <option value="TLB">TLB</option>
                               <option value="NRC">NRC</option>
                               <option value="JC">JC</option>
                               <option value="OTHERS">OTHERS</option>
                           </select>
                       </div>
                       <img class="triangle" style="width: 10px" src="dist/images/oil/Shape1@2x.png">
                   </div>
               </div>
               <div class="item">
                   <div class="title" style="width: 30%;">
                       <span class="">工卡编号</span>
                       <span class="red">*</span>
                   </div>
                   <div class="right" style="width: 65%;">

                       <input style="display: inline-block;margin-right: 1rem;text-align: right;width: 90%"   ng-model="info.card.cardNumber" ng-readonly="createMark == 'SYSTEM'" type="text"  placeholder="请填写工卡号">
                       <i style="top: 7px;" class="tlb-scan tlb-img" ng-if ="info.card.cardType == 'JC' || info.card.cardType == 'NRC'" ng-click="scan()"></i>

                   </div>
               </div>
           </div>
           <div class="section-2">
               <div class="header">故障缺陷或者原因描述</div>
               <div class="textarea-item">
                   <div class="title">
                       <span>中文描述</span>
                       <span class="red">*</span>
                   </div>
                   <div>
                       <textarea ng-model="info.basic.cnDescribe"></textarea>
                   </div>
                   <div class="line"></div>
               </div>
               <div class="textarea-item">
                   <div class="title">
                       <span>English</span>
                       <span class="red">*</span>
                   </div>
                   <div>
                       <textarea ng-model="info.basic.enDescribe"></textarea>
                   </div>
               </div>

           </div>
            <div class="section-3">
                <div class="tlb-oil-wrapper">
                    <oil-ewis  edit="isCreatTLB"
                               ac-reg="info.basic.flightNoInfo.label"
                               is-has-ewis="oilEwisInfo.isHasEwis" ewis-show="oilEwisInfo.showEwis"
                               ewis-state="oilEwisInfo.ewisState" ewis-dto="oilEwisInfo.ewisDTO"
                               ewis-index="oilEwisInfo.selectedEwisIndex" ewis-info="oilEwisInfo.ewisInfo"
                               is-has-oil="oilEwisInfo.isHasOil" oil-show="oilEwisInfo.showOil"
                               oil-state="oilEwisInfo.oilState" oil-dto="oilEwisInfo.oilDTO"
                               oil-index="oilEwisInfo.selectedOilIndex" oil-info="oilEwisInfo.oilInfo"
                    ></oil-ewis>
                </div>
            </div>

           <div class="section-4">
               <div class="header">添加图片&nbsp;
<!--                   <span>(限5张)</span>-->
               </div>
<!--               <div class="p-image">-->
<!--                   <img-sel img-arr="imgArr" file-arr="fileArr" is-api-cloud="isApiCloud"-->
<!--                            attachvo="attachvo" is-edit="isEdit"  max-img-count="maxImgCount" del-img-id="delImgId"></img-sel>-->
<!--               </div>-->
               <div class="p-image">
                   <img-select  img-arr="imgArr" file-arr="fileArr" is-api-cloud="isApiCloud" del-img-id="delImgId"  attachvo="attachvo"></img-select>
               </div>
               <div class="item" style="border-top:1px solid #E6E6E6;">
                   <div class="title">
                       <span class="">方案制定人</span>
                       <span class="red">*</span>
                   </div>
                   <div class="right ipt">
                       <select-person is-required="true"  person-info="info.report"></select-person>
                   </div>
               </div>

           </div>






           <div class="save-button-section">
<!--               <button style="width: 45%; margin-right: 4%"-->
<!--                       ng-class="{-->
<!--                       'button-active':-->
<!--                        info.basic.skill.length > 0 &&-->
<!--                        info.basic.itemcat.length > 0 &&-->
<!--                        info.card.cardType.length > 0 &&-->
<!--                        info.mech.nameAndId!=''  &&-->
<!--                        info.report.nameAndId!='' &&-->
<!--                       ((oilEwisInfo.isHasEwis == 'y' && oilEwisInfo.ewisDTO.length > 0) || oilEwisInfo.isHasEwis == 'n' )  &&-->
<!--                       ((oilEwisInfo.isHasOil == 'y' && oilEwisInfo.oilDTO.length > 0) || oilEwisInfo.isHasOil == 'n' )-->
<!--                       } "-->
<!--                       ng-disabled="-->
<!--                       info.basic.skill=='' ||-->
<!--                       info.basic.itemcat =='' ||-->
<!--                       info.card.cardType == '' ||-->
<!--                       info.mech.nameAndId=='' ||-->
<!--                       info.report.nameAndId=='' ||-->
<!--                       !((oilEwisInfo.isHasEwis == 'y' && oilEwisInfo.ewisDTO.length > 0) || oilEwisInfo.isHasEwis == 'n' ) ||-->
<!--                      !((oilEwisInfo.isHasOil == 'y' && oilEwisInfo.oilDTO.length > 0) || oilEwisInfo.isHasOil == 'n' )"-->
<!--                       ng-click="submit('save')"-->
<!--               >-->

                   <button style="width: 45%; margin-right: 4%" class="button-active" ng-click="submit('save')">
                     保存
                    </button>
               <button style="width: 45%;"  ng-class="{
                       'button-active':
                        info.basic.skill &&
                        info.basic.itemcat  &&
                        info.card.cardType.length > 0 &&
                        info.basic.cansee.length > 0 &&
                        info.basic.enDescribe.length> 0 &&
                        info.basic.cnDescribe.length > 0 &&
                        info.mech.approverName.length > 0  &&
                        info.report.approverName.length > 0 &&
                       ((oilEwisInfo.isHasEwis == 'y' && oilEwisInfo.ewisDTO.length > 0) || oilEwisInfo.isHasEwis == 'n' )  &&
                       ((oilEwisInfo.isHasOil == 'y' && oilEwisInfo.oilDTO.length > 0) || oilEwisInfo.isHasOil == 'n' )&&
                       ((info.basic.source==2&&!!info.basic.eng)||info.basic.source==1)
                       }"
                       ng-disabled="
                       info.basic.skill.length == 0 ||
                       !info.basic.skill ||
                       info.basic.itemcat.length == 0  ||
                       !info.basic.itemcat||
                       info.basic.cansee.length == 0  ||
                       !info.basic.cansee||
                       info.card.cardType.length == 0  ||
                       !info.card.cardType||
                       info.basic.enDescribe.length == 0  ||
                       !info.basic.enDescribe||
                       info.basic.cnDescribe.length == 0  ||
                       !info.basic.cnDescribe||
                       info.mech.approverName.length == 0 ||
                       !info.mech.approverName||
                       info.report.approverName.length == 0 ||
                       !info.report.approverName||
                       !((oilEwisInfo.isHasEwis == 'y' && oilEwisInfo.ewisDTO.length > 0) || oilEwisInfo.isHasEwis == 'n' ) ||
                      !((oilEwisInfo.isHasOil == 'y' && oilEwisInfo.oilDTO.length > 0) || oilEwisInfo.isHasOil == 'n' ) ||
                     (info.basic.source==2&&!info.basic.eng)"
                       ng-click="submit('submit')">
                   提交
               </button>
<!--               <button ng-class="{'button-active':myForm.$valid && info.damageInfo.checkType.length>0 && info.damageInfo.operator.length > 0-->
<!--                                                    && info.toolInfos.drDate.getTime() <= info.toolInfos.today.getTime() && info.toolInfos.selectedDamageReasons.length > 0 && info.toolInfos.selectedDamageTypes.length > 0} "-->
<!--                       ng-disabled="!myForm.$valid || info.damageInfo.checkType.length==0 || info.damageInfo.operator.length == 0 || info.toolInfos.drDate.getTime() > info.toolInfos.today.getTime() || info.toolInfos.selectedDamageReasons.length == 0 || info.toolInfos.selectedDamageTypes.length == 0"-->
<!--                       ng-click="submit(false)">-->
<!--                   保存-->
<!--               </button>-->
<!--               <button ng-if="info.damageInfo.id.length > 0"-->
<!--                       ng-class="{'button-active':myForm.$valid && info.damageInfo.checkType.length>0 && info.damageInfo.operator.length > 0 && info.damageInfo.id.length > 0 && info.toolInfos.drDate.getTime() <= info.toolInfos.today.getTime() &&-->
<!--                       info.toolInfos.selectedDamageReasons.length > 0 && info.toolInfos.selectedDamageTypes.length > 0}"-->
<!--                       ng-disabled="!myForm.$valid || info.damageInfo.checkType.length==0 || info.damageInfo.operator.length == 0-->
<!--                       ||info.damageInfo.id.length ==0 || info.toolInfos.drDate.getTime() > info.toolInfos.today.getTime()-->
<!--                       ||info.toolInfos.selectedDamageReasons.length == 0 || info.toolInfos.selectedDamageTypes.length == 0"-->
<!--                       ng-click="submit(true)">-->
<!--                   提交-->
<!--               </button>-->
           </div>
       </div>
    </form>
</div>
<div class="damage-confirm" ng-if="showConfirmState">
    <div class="background"></div>
    <div class="damage-confirm-box">
        <div class="damage-confirm-con">
            <div class="title">损伤编号</div>
            <div class="advice">意见</div>
            <div>
                <textarea name="" ng-model=""></textarea>
            </div>
            <div class="notice">*提交后将不能被修改</div>
            <div class="buttons">
                <button class="ensure" ng-click="submit(true)">确认提交</button>
                <button ng-click="hideConfim()">取消</button>
            </div>
        </div>
    </div>

</div>
<ewis ac-reg="info.basic.flightNoInfo.label" ng-show="oilEwisInfo.showEwis" ewis-show="oilEwisInfo.showEwis" state="oilEwisInfo.ewisState" ewis-dto="oilEwisInfo.ewisDTO" index="oilEwisInfo.selectedEwisIndex" ewis-info="oilEwisInfo.ewisInfo" is-edit="isCreatTLB"></ewis>
<oil ng-show="oilEwisInfo.showOil" oil-show="oilEwisInfo.showOil" state="oilEwisInfo.oilState" oil-dto="oilEwisInfo.oilDTO" index="oilEwisInfo.selectedOilIndex" oil-info="oilEwisInfo.oilInfo" is-edit="isCreatTLB"></oil>



