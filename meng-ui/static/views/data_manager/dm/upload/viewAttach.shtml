<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head id="i18n_" module="">
    <!--#include virtual="/views/items/resource_.shtml"-->
    <title data-i18n="">附件信息</title>
</head>
<body class="ibody">

    <div class="ibox-content">
            <table class="table table-bordered table-info" id="dg">

                <tr>
                    <th class="td5" style="width:110px;text-align: left"> 文件名</th>
                </tr>
            </table>
    </div>
<script type="text/javascript" src="/js/datagrid_utils.js"></script>
<script type="text/javascript">
    var PAGE_DATA = {};
    var param;
    var operation;
    function i18nCallBack() {
        param = getParentParam_();
        operation = param.operation;
        InitDataGrid(param.pkid, param.category);
    }

    function InitDataGrid(pkid, category) {
        InitFuncCodeRequest_({
            data: {
                SOURCE_ID: pkid,
                CATEGORY: category,
                FunctionCode: 'ATTACHMENT_RSPL_GET'
            },
            successCallBack: function (jdata) {
                //为0时提示没有上传附件，无法查看
                // if (jdata.data.length==0){
                //     MsgAlert({content: "请先上传附件", type: 'error'});
                //     return;
                // }

                for (var i = 0; i < jdata.data.length; i++) {
                    var trHTML = '<tr align="left"><td class="td5" align="left" style="text-align:left;font-size: 16px"><a target="_blank" onclick="downFile(' + jdata.data[i].PKID + ',' + jdata.data[i].PKID + ')">' + jdata.data[i].ORG_NAME + '</a></td></tr>';
                    $("#dg").append(trHTML);//在table最后面添加一行
                    // downFile(jdata.data[i].PKID,jdata.data[i].PKID);
                }
            }
        });
    }    //删除的时候一块删除业务表的file_path
    // function deleteFile(pkid){
    //     if(!confirm("确认删除?")){
    //         return;
    //     }
    //     InitFuncCodeRequest_({
    //         data:{pkid:pkid,FunctionCode:'DM_DATA_UP_DELETE'},
    //         successCallBack: function (jdata) {
    //             if (jdata.code == 200) {
    //                 InitFuncCodeRequest_({
    //                     data: {pkid: pkid, FunctionCode: 'ATTACHMENT_RSPL_DEL'},
    //                     successCallBack: function(jdata){
    //                         if(jdata.code == RESULT_CODE.SUCCESS_CODE){
    //                             MsgAlert({content: jdata.msg ? jdata.msg : $.i18n.t('msg_tip:TIP.COMMON.OPT_SUCCESS')});
    //                             reload_();
    //                         }
    //                     }
    //                 });
    //
    //             }
    //         }
    //     });
    // }
    //刷新
    function reload_() {
        location.reload();
    }

    //查询
    function searchData() {
        onSearch_('dg', '#ffSearch');
    }

    //重置
    function doClear_() {
        $("#ffSearch").form('clear');
        searchData();
    }

</script>
</body>
</html>