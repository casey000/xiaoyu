<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head id="i18n_" module="">
    <!--#include virtual="/views/items/resource_.shtml"-->
    <meta charset="UTF-8">
    <title></title>
    <link href="/css/common_new.css" rel="stylesheet" type="text/css"/>
    <link href="/css/jquery-ui-1.8.2.custom.css" rel="stylesheet" type="text/css"/>
    <link href="/css/ui.jqgrid.css" rel="stylesheet" type="text/css"/>
    <link href="/css/common_new.css" rel="stylesheet" type="text/css"/>
    <link href="/css/common_from_me.css" rel="stylesheet" type="text/css"/>
    <link href="/css/dialog_default.css" rel="stylesheet" type="text/css"/>
    <link href="/css/easyui.css" rel="stylesheet" type="text/css"/>
    <link href="/js/jquery/ztree/zTreeStyle.css" rel="stylesheet" type="text/css"/>
    <!-- <link rel="stylesheet" type="text/css" href="/css/easyui/gray/easyui.css"/> -->
    <link href="/css/common_qc.css" rel="stylesheet" type="text/css"/>
    <link href="/js/jquery/jquery-ui-multiselect/jquery.multiselect.css" rel="stylesheet" type="text/css"/>


    <script src="/js/global_var.js"></script>

    <script src="/js/jquery/easyui/jquery-1.8.0.min.js" type="text/javascript"></script>

    <!-- multiSelect -->
    <script src="/js/jquery-ui-1.8.16.custom.min.js" type="text/javascript"></script>
    <script src="/js/jquery/jquery-ui-multiselect/src/jquery.multiselect.js" type="text/javascript"></script>

    <!-- easy UI -->
    <script src="/js/jquery/easyui/jquery.easyui.min.js" type="text/javascript"></script>
    <script src="/js/jquery/easyui/locale/easyui-lang-zh_CN.js" type="text/javascript"></script>

    <!-- Ztree 使用了tree类型的查询条件定义则需要引入此js -->
    <script src="/js/jquery/ztree/jquery.ztree.core-3.4.js" type="text/javascript"></script>
    <script src="/js/jquery/ztree/jquery.ztree.excheck-3.4.js" type="text/javascript"></script>

    <!-- jqGrid-->
    <script src="/js/jquery/jqGrid/jquery.jqGrid.min.js" type="text/javascript"></script>
    <script src="/js/jquery/jqGrid/i18n/grid.locale-cn.js" type="text/javascript"></script>

    <script src="/js/jquery/lhgdialog/lhgdialog.js" type="text/javascript"></script>

    <script src="/js/sfa-query-1.0.js" type="text/javascript"></script>
    <script src="/js/date_utils_from_me.js" type="text/javascript"></script>
    <script src="/js/sfa-executor.js" type="text/javascript"></script>
    <script src="/js/sfa-export.js" type="text/javascript"></script>

    <script src="../../../js/datagrid_utils.js" type="text/javascript"></script>
</head>

<body>
<div id="qc_box"></div>
<div class="list_btn_row_s qc_template" id="qc_template_box"></div>
<div class="qc_advance" id="qc_advance_box"></div>
<div class="list_btn_row">


</div>
<div class="listbox">
    <div class="gridbox">
        <div class="grid_tab">
            <table id="common_list_grid"></table>
            <div id="gridPager"></div>

        </div>
    </div>
</div>
</body>
<script type="application/javascript">
    let params = getParentParam_();
    var optsCols = [];
    optsCols.push("del");
    var permissionMap = {
        view: false,
        mrview: false,
        remark: false
    };

    var loginInfo;
    $(function () {
        loginInfo = getLoginInfo();
        var options = {
            view: "V_NRC_BASE",
            defaultParam: {
                'qname': ['nrcProcessStatus', 'delFlag'],
                'qoperator': ['equals', 'equals'],
                'qvalue': ["APPROVED", "n"]
            },
            qcOptions: {
                qcBoxId: "qc_box"
            },
            gridOptions: {
                gridId: "common_list_grid",
                allColModels: {

                    'del': {
                        name: 'D',
                        colNameEn: 'D',
                        isOpts: true,
                        width: 80,
                        formatter: function (cellValue, options, rowObj) {
                            var ele = '<div id="delete_ner' + rowObj.nrcId + '" style="width: 50px;height: 23px;background-color: #2465a8;color: #ffffff;cursor: pointer;line-height: 23px;margin-left: 15px;border-radius: 4px;" title="delete">确定</div>';
                            $('#delete_ner' + rowObj.nrcId).live('click', function () {
                                nrc_delete(rowObj);
                            });
                            return ele;

                        }
                    },
                    'hoReason': {
                        formatter: hoReasonFun,
                        width: 150
                    },
                    'nrcNo': {
                        name: 'nrcNo',
                        colNameEn: 'nrcNo',
                        formatter: function (cellValue, options, rowObj) {
                            if (rowObj.nrcNo == null) {
                                return "<span>null</span>";
                            } else {
                                var ele = '<span id="nrcno_' + rowObj.nrcId + '" title="' + rowObj.nrcNo + '" style="cursor: pointer;color: #f60; ">' + rowObj.nrcNo + '</span>';

                                return ele;
                            }
                        }
                    },
                    'isRepeat': {
                        formatter: "select",
                        editoptions: {
                            value: {1: "YES", null: "NO"}
                        },
                        formatType: 'map',
                        pattern: {
                            "1": "YES",
                            "0": "NO",
                            "null": "NO"
                        }
                    },
                    'timeLimitType': {
                        formatter: "select",
                        editoptions: {
                            value: {1: "硬时限", 2: "软时限"}
                        },
                        formatType: 'map',
                        pattern: {
                            "1": "硬时限",
                            "2": "软时限",
                            "": ""
                        }
                    },
                    'defect': {
                        formatter: "select",
                        editoptions: {
                            value: {"n": "NO", "y": "YES"}
                        },
                        /*
                        * 配置列表导出Format
                        *  formatType： map | merge
                        *  pattern : {}
                        * */
                        formatType: 'map',
                        pattern: {
                            // "y":"<font style='color:green'>在位</font>", //允许添加样式进行填充
                            "n": "NO",
                            "y": "YES",
                            "": ""
                        }
                    },
                    'isHasEwis': {
                        formatter: "select",
                        editoptions: {
                            value: {"n": "NO", "y": "YES"}
                        },
                        formatType: 'map',
                        pattern: {
                            "n": "NO",
                            "y": "YES",
                            "": ""
                        }
                    },
                    'isHasOil': {
                        formatter: "select",
                        editoptions: {
                            value: {"n": "NO", "y": "YES"}
                        },
                        formatType: 'map',
                        pattern: {
                            "n": "NO",
                            "y": "YES",
                            "": ""
                        }
                    },
                    'isrepeat': {
                        formatter: "select",
                        editoptions: {
                            value: {0: "NO", 1: "YES"}
                        },
                        formatType: 'map',
                        pattern: {
                            "0": "NO",
                            "1": "YES",
                            "": ""
                        }
                    },
                    'skill': {
                        formatter: "select",
                        editoptions: {
                            value: {1: "ME", 2: "AV", 3: "STR"}
                        },
                        formatType: 'map',
                        pattern: {
                            "1": "ME",
                            "2": "AV",
                            "3": "STR"
                        }
                    }
                },
                jqGridSettings: {
                    height: 500,
                    multiselect: true
                },

                optsFirst: true,
                optsCols: optsCols,


            },

        };
        $(document).sfaQuery(options);

        // hoReason的显示转换
        function hoReasonFun(cellvalue, options, rowObject) {
            if (cellvalue == null || cellvalue == 'null') {
                cellvalue = "";
            } else {
                cellvalue = cellvalue.replace("1", "TS");
                cellvalue = cellvalue.replace("2", "MATERIAL");
                cellvalue = cellvalue.replace("3", "SPEC. TOOLS");
                cellvalue = cellvalue.replace("4", "TIME LIMIT");
                cellvalue = cellvalue.replace("5", "OTHER");
            }
            return cellvalue;
        }

        function nrc_delete(obj) {
            params.success(obj);
            close_window();
        }

        /**
         * 关闭当前窗口
         * @return {void}
         */
        function close_window() {
            window.opener = null;
            window.open('', '_self');
            window.close();
        }

    });


</script>
</html>