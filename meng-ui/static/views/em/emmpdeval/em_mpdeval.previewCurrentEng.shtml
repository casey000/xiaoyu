<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html
>
<head id="i18n_" module="pm_mplanconf">
    <!--#include virtual="/views/items/resource_.shtml"-->
    <script type="text/javascript" src="/js/plugins/ajaxfileupload/ajaxfileupload.js"></script>
    <title>预览发动机适用性</title>
</head>
<body>

<div style="">
    <div class="ibox float-e-margins">
        <div class="ibox-content">
            <fieldset class="fieldset_eui">
                <legend data-i18n="" id="id1">发动机适用性</legend>

                <fieldset class="fieldset_eui" style="margin-right:5px">
                    <!--<legend data-i18n="" id="id2">适用部件&nbsp;&nbsp;&nbsp;</legend>-->
                    <span id="acnoInfos" style="color: red"></span>
                    <table cellspacing="0" cellpadding="2">
                    </table>
                    <table id="dg"></table>
                </fieldset>
            </fieldset>
        </div>
    </div>
</div>
</body>
<script type="text/javascript" src="/js/datagrid_utils.js"></script>
<script type="text/javascript">
    var param = {};
    var fleet;
    var appltype;
    var evalNo;
    var PAGE_DATA = {};
    param = getParentParam_();
    evalNo = param.evalNo;//评估单号
    appltype = param.appltype;
    fleet = param.fleet;
    var checkAcnos = {};

    function i18nCallBack() {
        InitFuncCodeRequest_({
            data: {evalNo: param.evalNo, fleet: fleet, appltype: param.appltype, FunctionCode: "EM_MPD_SYFJ"},
            successCallBack: function (jdata) {
                if (jdata.code == RESULT_CODE.SUCCESS_CODE) {
                    checkAcnos = jdata.data;
                }
            }
        });
        InitDataGrid();
    }

    function InitDataGrid() {
        var identity = 'dg';
        $("#dg").MyDataGrid({
            identity: identity,
            fitcolumn: true,
            queryParams: {evalNo: evalNo},
            // resize: function () {
            //     return tabs_standard_resize($('#tt'), 60, 0.50, 10, -10);
            // },
            columns: {
                param: {FunctionCode: "EM_MPD_ENG_CURRENT_PREVIEW"},
            },
            resize: function () {
                return {width: 500, height: 370};
            },
            onLoadSuccess: function (data) {
                var acnosInfos = "发动机总数：" + data.total;
                $("#acnoInfos").html(acnosInfos);
                if (data) {
                    $.each(data.rows, function (index, item) {
                        for (var i = 0; i < checkAcnos.length; i++) {
                            if (checkAcnos[i].acid == item.ACID) {
                                $('#dg2').datagrid('checkRow', index);
                            }
                        }

                    });
                }
            }
        });
    }

    function closeAdd() {
        $.messager.confirm('', '是否关闭', function (r) {
            if (r) {
                CloseWindowIframe();
                param.OWindow.reload_();
                $("#dg").form('clear');
            }
        });
    }

    /** 刷新列表数据 */
    function reload_() {
        $("#dg").datagrid("reload");
    }


</script>
</html>