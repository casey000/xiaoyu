<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head id="i18n_" module="">
    <!--#include virtual="/views/items/resource_.shtml"-->
    <title>EA设置时限</title>
</head>

<body>
<div style="width: 980px;margin:0 auto;">
    <div class="ibox float-e-margins">
        <div class="ibox-content">
            <form class="form-horizontal m-t" id="mform">
                <table border="0" cellpadding="0" cellspacing="0" style="width: 98%;">
                    <tr>
                        <td style="width: 200px;">
                            时限分组：
                        </td>
                        <td class="tdl">
                            时限分组编号：
                        </td>
                        <td class="tdr">
                            <input class="easyui-numberbox" type="text" value="1"
                                   data-options="min:0,max:100000,precision:0,required:true,editable:false"
                                   name="tlimitGroupNo" id="tlimitGroupNo"
                            />
                        </td>
                        <td style="text-align: right;">
                            <input id="dead" class="btn btn-primary" type="button" onclick="checkDeadLine()" value="到期时限预计算"
                                   style="width: 100px;margin:5px;"/>

                            <input class="btn btn-primary" type="button" onclick="save()" value="保存"
                                   style="width: 50px;margin:5px;"/>

                            <input id="closeBtn" class="btn btn-primary" type="button" onclick="CloseWindowIframe()" value="关闭"
                                   style="width: 50px;margin:5px;"/>
                        </td>
                    </tr>
                </table>

                <div id="sp1" class="easyui-panel" style="width: 980px; height:150px;  ">
                    <table border="0" cellpadding="0" cellspacing="0" style="width: 98%;">
                        <tr>
                            <th class="tdl">适用性分组:</th>
                            <td class="tdr" style="text-align: right;">
                                <input class="btn btn-primary" type="button" onclick="addApp()" value="维护适用性分组"
                                       style="width: 100px;margin:5px;"/>
                                <input id="viewAppGroup" class="btn btn-primary" type="button" onclick="viewApp()" value="查看"
                                       style="width: 50px;margin:5px;"/>
                            </td>
                        </tr>
                    </table>
                    <table id="dg9" style="width: 98%;padding:10px;"></table>
                </div>

                <input type="hidden" id="pkid" name="pkid"/>

                <div id="sp2" class="easyui-panel" title="首检" style="width: 980px;padding:10px; ">
                    <table width="98%">
                        <tr>
                            <td>
                                <!--<input style="width: 50px;margin:5px;" type="button" class="btn btn-primary"
                                       onclick="saveFC()" id="saveFc" value="保存">-->
                                <input style="width: 80px;margin:5px;" type="button" class="btn btn-danger"
                                       onclick="resetTl('fc')" id="resetFc" value="清空">
                                <input type="checkbox" id="ifFcNote" name="ifFcNote" style="margin-left: 725px;display: none" _index="0"
                                       onclick="this.value=this.checked?' Y':'N'" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <table id="appendTable" width="100%" border="0" cellspacing="0" cellpadding="0">
                                    <tr>
                                        <td width="80%"><!--第二层的table begin-->
                                            <table  width="100%" border="0" cellspacing="0" cellpadding="0">
                                                <tr>
                                                    <td width="95%" style="border:none"><!--第三层的table begin-->
                                                        <table  width="100%" border="0" cellspacing="0" cellpadding="0" class="table_sub_1">
                                                            <tr name="fcSgTr">
                                                                <td width="75%" style="border:solid #ccc 1px;">
                                                                    <!--首检值table-->
                                                                    <table border="1" cellpadding="0" cellspacing="0"
                                                                           bordercolor="#B2C9E0" class="table-zi"
                                                                           style="margin:5px;padding: 5px">
                                                                        <tr>
                                                                            <!-- begin if -->
                                                                            <td style="padding: 3px" width="5%"
                                                                                valign="top" name="unit">
                                                                                <select name="vo.complianceTimes[0].eoSub1[0].eoSub2[0].eoSub3[0].startingLabel" class="doc_type" onchange="value_change_first(this)">
                                                                                </select>
                                                                            </td>
                                                                            <!-- nowrap="nowrap"  -->
                                                                            <td style="padding: 3px" width="10%"
                                                                                class="remove_content_td" name="value">
                                                                                <input type="text"
                                                                                       class="{rangelength:[0,100]}"
                                                                                       name="vo.complianceTimes[0].eoSub1[0].eoSub2[0].eoSub3[0].startingValue"
                                                                                       style="width: 90px"/>
                                                                            </td>
                                                                            <td style="padding: 3px" width="15%"
                                                                                name="isPost" class="remove_content_td">
                                                                                <input style="margin-left: 5px"
                                                                                       type="checkbox"
                                                                                       name="vo.complianceTimes[0].eoSub1[0].eoSub2[0].eoSub3[0].isPost"
                                                                                       onclick="postClick(this)">POST
                                                                            </td>
                                                                            <td width="10%" name="postType" style="display: none">
                                                                                <select style="margin: 3px"
                                                                                        name="vo.complianceTimes[0].eoSub1[0].eoSub2[0].eoSub3[0].postType"
                                                                                        class="doc_type"
                                                                                        onchange="value_change_first(this)">
                                                                                </select>
                                                                            </td>
                                                                            <td width="15%" name="post" style="display: none">
                                                                                <input style="margin: 3px;width: 150px"
                                                                                       type="text"
                                                                                       name="vo.complianceTimes[0].eoSub1[0].eoSub2[0].eoSub3[0].post">
                                                                            </td>
                                                                            <td width="15%" name="isSince" class="remove_content_td">
                                                                                <input type="checkbox" name="vo.complianceTimes[0].eoSub1[0].eoSub2[0].eoSub3[0].isSince" onclick="sinceClick(this)">Since
                                                                            </td>
                                                                            <td width="10%" name="sinceType" style="display: none">
                                                                                <select name="vo.complianceTimes[0].eoSub1[0].eoSub2[0].eoSub3[0].sinceType" class="doc_type" onchange="">
                                                                                </select>
                                                                            </td>
                                                                            <td style="width:15%;padding: 3px" name="deadLine" class=".remove_content_td">
                                                                                截止日期：<input style="margin: 3px;width: 90px" type="text" name="vo.complianceTimes[0].eoSub1[0].eoSub2[0].eoSub3[0].deadLine"/>
                                                                            </td>
                                                                            <td width="5%">
                                                                                <div>
                                                                                    <img id="del"
                                                                                         onclick="del_query_tr_first(this);return false;"
                                                                                         src="../../../../../css/icons/delete.png"
                                                                                         style="margin-left: 5px;"/>
                                                                                    <!--<input id="del" type="button" onclick="del_query_tr_first(this);return false;">-->
                                                                                </div>
                                                                            </td>
                                                                        </tr>

                                                                    </table>
                                                                    <!--第四层table begin-->
                                                                    <!--第四层table begin-->
                                                                </td>
                                                                <td width="10%" style="border:solid #ccc 1px;">
                                                                    <div>
                                                                        <!--<input id="add" name="fc" type="button" onclick="add_query_tr_first(this);return false;">-->
                                                                        <img id="add"
                                                                             onclick="add_query_tr_first(this);return false;"
                                                                             src="../../../../../css/icons/add.png"
                                                                             style="margin-left: 10px;"/>
                                                                    </div>
                                                                </td>
                                                                <td width="11%">
                                                                    <div>
                                                                        <ul style="padding-left:0px">
                                                                            <li style="list-style:none">
                                                                                &nbsp;<input name="vo.complianceTimes[0].eoSub1[0].eoSub2[0].firstLast" type="radio" value="XDWZ"  style="height:auto;display:none"/>
                                                                                <span style="display:none">FIRST</span> </li>
                                                                        </ul>
                                                                        <ul style="padding-left:0px">
                                                                            <li style="list-style:none">
                                                                                &nbsp;<input name="vo.complianceTimes[0].eoSub1[0].eoSub2[0].firstLast" type="radio" value="HDWZ" style="height:auto;display:none"/>
                                                                                <span style="display:none">LAST</span> </li>
                                                                        </ul>
                                                                    </div>
                                                                </td>
                                                                <td style="display: none">
                                                                    <div>
                                                                        <img id="del"
                                                                             onclick="del_query_tr_second(this);return false;"
                                                                             src="../../../../../css/icons/delete.png"/>
                                                                        <!--<input id="del" type="button" onclick="del_query_tr_second(this);return false;">-->
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                        <!--第三层的table end-->
                                                    </td>
                                                    <td width="5%" style="border:none; display: none">
                                                        <div>
                                                            <img id="add"
                                                                 onclick="add_query_tr_second(this);return false;"
                                                                 src="../../../../../css/icons/add.png"/>
                                                            <!--<input id="add" type="button" onclick="add_query_tr_second(this);return false;">-->
                                                        </div>
                                                    </td>
                                                </tr>
                                            </table>
                                            <!--第二层的table end-->
                                        </td>
                                        <td width="8%" style="border-right:none; border-top:none; border-bottom:none; display: none">
                                            <div>
                                                <ul style="padding-left:0px">
                                                    <li style="list-style:none">
                                                        &nbsp;<input name="vo.complianceTimes[0].eoSub1[0].firstLast" type="radio" style="height:auto;display:none" value="XDWZ"/>
                                                        <span style="display:none">FIRST</span> </li>
                                                </ul>
                                                <ul style="padding-left:0px">
                                                    <li style="list-style:none">
                                                        &nbsp;<input name="vo.complianceTimes[0].eoSub1[0].firstLast" type="radio" value="HDWZ" style="height:auto;display:none"/>
                                                        <span style="display:none">LAST</span> </li>
                                                </ul>
                                            </div>
                                        </td>
                                        <td width="12%" style="border-right:none; border-top:none; border-bottom:none;display: none">
		                                <textarea id="fcNote" class="{rangelength:[0,1000]}"
                                                  name="fcNote" rows="4" style="width:100%;"></textarea>
                                            <div class="errorMessage"></div>
                                        </td>
                                    </tr>
                                </table>
                                <!--Threshold end-->
                            </td>
                        </tr>
                        <tr id="setIlTr">
                            <td>
                                是否设置提前量：<input type="easyui-combobx" id="ifSetIl" name="ifSetIl" style="width: 50px">
                                </select>
                                <input class="easyui-textbox" style="width: 60px" id="initialLead" disabled="disabled"
                                       name="initialLead"
                                       data-options="required:false,editable:true"/>%
                            </td>
                        </tr>
                    </table>
                    <!--<table class="table table-bordered table-info">
                        <tr style="height: 40px">
                            <th style="width: 50px;">
                                首检：
                            </th>
                            <td>
                                <legend>首检说明：<input type="checkbox" id="ifFcNote" name="ifFcNote" value="N">NOTE
                                </legend>
                            </td>
                            <td>
                                首检大组：
                            </td>
                            <td>
                                <table id="dg1">
                                    <tr>
                                        <input type="hidden" id="fcBgNo" name="fcBgNo" value="1">
                                        <th class="th" align="right" style="width: 90px;">首检大组原则：</th>
                                        <td>
                                            <input class="easyui-combobox" style="width:90px" id="fcBgPrinciple" name="fcBgPrinciple"
                                                   data-options="required:false,editable:true,validType:'comboBoxEditvalid[\'fcBgPrinciple\']'"/>
                                        </td>
                                        <th class="th" align="right" style="width: 100px;">是否设置提前量：</th>
                                        <td>
                                            <input class="easyui-combobox" style="width: 45px" id="ifSetIl" name="ifSetIl"
                                                   data-options="required:false,editable:true,validType:'comboBoxEditvalid[\'ifSetIl\']'"/>
                                        </td>

                                        <th class="th" align="right" style="width: 60px;">提前量：</th>
                                        <td>
                                            <input class="easyui-textbox" style="width: 60px" id="initialLead" disabled="disabled"
                                                   name="initialLead"
                                                   data-options="required:false,editable:true"/>%
                                        </td>
                                        <td class="text-align: right;">
                                            <input class="btn btn-primary" type="button" onclick="saveBg()" value="保存"
                                                   style="width: 50px;margin:5px;"/>
                                        </td>
                                        <td class="text-align: right;">
                                            <input class="btn btn-primary" type="button" onclick="delBgData()" value="删除"
                                                   style="width: 50px;margin:5px;"/>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                            <td class="text-align: right;">
                                <input class="btn btn-primary" type="button" onclick="save()" value="保存NOTE"
                                       style="width: 70px"/>
                            </td>
                        </tr>
                    </table>
                    <fieldset id="fcsg" class="fieldset_eui" style="float:left;width:19%;height:250px">
                        <p>首检小组：</p>
                        <table id='dg2' style="width:98%;height:95%">
                        </table>
                    </fieldset>
                    <fieldset id="fcv" class="fieldset_eui" style="float:left;width:57%;height:250px">
                        <p>首检值：</p>
                        <table id='dg3' style="width:98%;height:95%">
                        </table>
                    </fieldset>
                    <fieldset class="fieldset_eui" style="float:left;width:19%;height:250px">
                        <table style="width:100%;height:100%">
                            <td>
                                <input class="easyui-textbox easyui-validatebox" id="fcNote" name="fcNote"
                                       style="width:100%;height:100%;border: 1px solid #ddd;border-radius: 5px;"
                                       data-options="multiline:true,editable:false,onlyview:true"/>
                            </td>
                        </table>
                    </fieldset>-->


                </div>


                <div id="sp3" class="easyui-panel" title="重检分组" style="width: 980px;padding:10px; ">
                    <table width="98%">
                        <tr>
                            <td>
                                <!--<input style="width: 50px;margin:5px;" class="btn btn-primary" type="button"
                                       onclick="saveRC()" id="saveRc" value="保存">-->
                                <input style="width: 80px;margin:5px;" type="button" class="btn btn-danger"
                                       onclick="resetTl('rc')" id="resetRc" value="清空">
                                <input type="checkbox" id="ifRcNote" name="ifRcNote" style="margin-left: 725px;display: none" _index="0"
                                       onclick="this.value=this.checked?' Y':'N'" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <table id="appendTableRc" width="100%" border="0" cellspacing="0" cellpadding="0">
                                    <tr>
                                        <td width="80%"><!--第二层的table begin-->
                                            <table  width="100%" border="0" cellspacing="0" cellpadding="0">
                                                <tr>
                                                    <td width="95%" style="border:none"><!--第三层的table begin-->
                                                        <table  width="100%" border="0" cellspacing="0" cellpadding="0" class="table_sub_1">
                                                            <tr name="rcSgTr">
                                                                <td width="75%" style="border:solid #ccc 1px;">
                                                                    <!--重检值table-->
                                                                    <table border="1" cellpadding="0" cellspacing="0" bordercolor="#B2C9E0" class="table-zi" style="margin:5px;padding: 5px">
                                                                        <tr>
                                                                            <!-- begin if -->
                                                                            <td style="padding: 3px" width="10%" valign="top" name="rcUnit">
                                                                                <select name="vo.complianceTimes[0].eoSubRc1[0].eoSubRc2[0].eoSubRc3[0].rcStartingLabel" class="doc_type" onchange="value_change_first(this)">
                                                                                </select>
                                                                            </td>
                                                                            <!-- nowrap="nowrap"  -->
                                                                            <td style="padding: 3px;width:15%" class="remove_content_td" name="value" valign="top">
                                                                                <input type="text" style="width:90px" class="{rangelength:[0,100]}"
                                                                                       name="vo.complianceTimes[0].eoSubRc1[0].eoSubRc2[0].eoSubRc3[0].startingValue"/>
                                                                            </td>
                                                                            <td style="padding: 3px" width="15%" name="isSince" class="remove_content_td">
                                                                                <input style="margin-left: 5px" type="checkbox" name="vo.complianceTimes[0].eoSubRc1[0].eoSubRc2[0].eoSubRc3[0].isSince" onclick="sinceClick(this)">Since
                                                                            </td>
                                                                            <td style="padding: 3px" width="10%" name="sinceType" style="display: none">
                                                                                <select name="vo.complianceTimes[0].eoSubRc1[0].eoSubRc2[0].eoSubRc3[0].sinceType" class="doc_type" onchange="">
                                                                                </select>
                                                                            </td>
                                                                            <td style="padding: 3px" width="20%" name="deadLine" class=".remove_content_td">
                                                                                <input type="text"  name="vo.complianceTimes[0].eoSubRc1[0].eoSubRc2[0].eoSubRc3[0].deadLine"/>
                                                                            </td>
                                                                            <td width="5%">
                                                                                <div>
                                                                                    <img id="delRc"
                                                                                         onclick="del_query_tr_first(this);return false;"
                                                                                         src="../../../../../css/icons/delete.png"
                                                                                         style="margin-left: 5px;"/>
                                                                                    <!--<input id="delRc" type="button" onclick="del_query_tr_first(this);return false;">-->
                                                                                </div>
                                                                            </td>
                                                                        </tr>

                                                                    </table>
                                                                    <!--第四层table begin-->
                                                                    <!--第四层table begin-->
                                                                </td>
                                                                <td width="10%" style="border:solid #ccc 1px;">
                                                                    <div>
                                                                        <!--<input id="addRc" name="fc" type="button" onclick="add_query_tr_first(this);return false;">-->
                                                                        <img id="addRc"
                                                                             onclick="add_query_tr_first(this);return false;"
                                                                             src="../../../../../css/icons/add.png"
                                                                             style="margin-left: 10px;"/>
                                                                    </div>
                                                                </td>
                                                                <td width="11%">
                                                                    <div>
                                                                        <ul style="padding-left:0px">
                                                                            <li style="list-style:none">
                                                                                &nbsp;<input name="vo.complianceTimes[0].eoSubRc1[0].eoSubRc2[0].firstLast" type="radio" value="XDWZ"  style="height:auto;display:none"/>
                                                                                <span style="display:none">FIRST</span> </li>
                                                                        </ul>
                                                                        <ul style="padding-left:0px">
                                                                            <li style="list-style:none">
                                                                                &nbsp;<input name="vo.complianceTimes[0].eoSubRc1[0].eoSubRc2[0].firstLast" type="radio" value="HDWZ" style="height:auto;display:none"/>
                                                                                <span style="display:none">LAST</span> </li>
                                                                        </ul>
                                                                    </div>
                                                                </td>
                                                                <td style="display: none">
                                                                    <div>
                                                                        <img id="delRc"
                                                                             onclick="del_query_tr_second(this);return false;"
                                                                             src="../../../../../css/icons/delete.png"/>
                                                                        <!--<input id="delRc" type="button" onclick="del_query_tr_second(this);return false;">-->
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                        <!--第三层的table end-->
                                                    </td>
                                                    <td width="5%" style="border:none; display: none">
                                                        <div>
                                                            <img id="addRc"
                                                                 onclick="add_query_tr_second(this);return false;"
                                                                 src="../../../../../css/icons/add.png"/>
                                                            <!--<input id="addRc" type="button" onclick="add_query_tr_second(this);return false;">-->
                                                        </div>
                                                    </td>
                                                </tr>
                                            </table>
                                            <!--第二层的table end-->
                                        </td>
                                        <td width="8%" style="border-right:none; border-top:none; border-bottom:none;display: none">
                                            <div>
                                                <ul style="padding-left:0px">
                                                    <li style="list-style:none">
                                                        &nbsp;<input name="vo.complianceTimes[0].eoSubRc1[0].firstLast" type="radio" style="height:auto;display:none" value="XDWZ"/>
                                                        <span style="display:none">FIRST</span> </li>
                                                </ul>
                                                <ul style="padding-left:0px">
                                                    <li style="list-style:none">
                                                        &nbsp;<input name="vo.complianceTimes[0].eoSubRc1[0].firstLast" type="radio" value="HDWZ" style="height:auto;display:none"/>
                                                        <span style="display:none">LAST</span> </li>
                                                </ul>
                                            </div>
                                        </td>
                                        <td width="12%" style="border-right:none; border-top:none; border-bottom:none;display: none">
		                                <textarea id="rcNote" class="{rangelength:[0,1000]}"
                                                  name="rcNote" rows="4" style="width:100%;"></textarea>
                                            <div class="errorMessage"></div>
                                        </td>
                                    </tr>
                                </table>
                                <!--Threshold end-->
                            </td>
                        </tr>
                    </table>
                    <!--<table class="table table-bordered table-info">
                        <tr style="height: 40px">
                            <th>
                                重检：
                            </th>
                            <td>
                                <legend>重检说明：<input type="checkbox" id="ifRcNote" name="ifRcNote" value="N">NOTE
                                </legend>
                            </td>
                            <td>
                                重检大组：
                            </td>
                            <td>
                                <table id="dg4">
                                    <tr>
                                        <input type="hidden" id="rcBgNo" name="rcBgNo" value="1">
                                        <th class="th" align="right" style="width: 90px;">重检大组原则：</th>
                                        <td>
                                            <input class="easyui-combobox" style="width:100px" id="rcBgPrinciple" name="rcBgPrinciple"
                                                   data-options="required:false,editable:true,validType:'comboBoxEditvalid[\'rcBgPrinciple\']'"/>
                                        </td>
                                        <td class="text-align: right;">
                                            <input class="btn btn-primary" type="button" onclick="saveBgRc()" value="保存"
                                                   style="width: 50px;margin:5px;"/>
                                        </td>
                                        <td class="text-align: right;">
                                            <input class="btn btn-primary" type="button" onclick="delBgRcData()" value="删除"
                                                   style="width: 50px;margin:5px;"/>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                            <td class="text-align: right;">
                                <input class="btn btn-primary" type="button" onclick="save()" value="保存NOTE"
                                       style="width: 70px;"/>
                            </td>
                        </tr>
                    </table>
                    &lt;!&ndash;<fieldset id="rcbg" class="fieldset_eui" style="float:left;width:17%;height:250px">
                        <p>重检大组：</p>
                        <table id='dg4' style="width:98%;height:95%">
                        </table>
                    </fieldset>&ndash;&gt;
                    <fieldset id="rcsg" class="fieldset_eui" style="float:left;width:19%;height:250px">
                        <p>重检小组：</p>
                        <table id='dg5' style="width:98%;height:95%">
                        </table>
                    </fieldset>
                    <fieldset id="rcv" class="fieldset_eui" style="float:left;width:57%;height:250px">
                        <p>重检值：</p>
                        <table id='dg6' style="width:98%;height:95%">
                        </table>
                    </fieldset>
                    <fieldset class="fieldset_eui" style="float:left;width:19%;height:250px">
                        <table style="width:100%;height:100%">
                            <td>
                                <input class="easyui-textbox easyui-validatebox" id="rcNote" name="rcNote"
                                       style="width:100%;height:100%;border: 1px solid #ddd;border-radius: 5px;"
                                       data-options="multiline:true,editable:false,onlyview:true"/>
                            </td>
                        </table>
                    </fieldset>
                    <fieldset class="fieldset_eui" style="float:left;width:98%;height:180px">

                        <table>
                            <tr>
                                <td>
                                    <input type="checkbox" id="ifVi" name="ifVi" value="N"> 是否可变间隔
                                </td>
                            </tr>
                        </table>
                        <table id='dg7'>
                        </table>
                    </fieldset>-->
                </div>

                <div id="fiViDiv" class="easyui-panel" title="" style="width: 980px;padding:10px; display: none">
                    <fieldset class="fieldset_eui" style="float:left;width:98%;height:20px">
                        <table>
                            <tr>
                                <td>
                                    <input type="checkbox" id="ifVi" name="ifVi" value="N"> 是否可变间隔
                                </td>
                            </tr>
                        </table>
                    </fieldset>
                </div>
                <div id="div7" class="easyui-panel" title="" style="width: 980px;padding:10px; ">
                    <fieldset class="fieldset_eui" style="float:left;width:98%;height:180px">
                        <table id='dg7'></table>
                    </fieldset>
                </div>

                <div id="sp4" class="easyui-panel" title="终结" style="width: 980px;padding:10px; ">


                    <table border="0" cellpadding="0" cellspacing="0" style="width: 100%;">
                        <tr>
                            <td style="width: 200px;">
                                终结条件：
                            </td>
                            <!--<td class="text-align: right;">
                                <input class="btn btn-primary" type="button" onclick="save()" value="保存"
                                       style="width: 50px;margin:5px;"/>
                            </td>-->
                        </tr>
                    </table>
                    <fieldset class="fieldset_eui" style="float:left;width:20%;height:250px">
                        <table cellspacing="0" cellpadding="2" class="table table-bordered table-info">

                            <tr>
                                <td class="tdr">
                                    <input class="easyui-textbox" name="windupFc" id="windupFc"
                                           data-options="validType:['intOrFloat','maxValue']"/>FC
                                </td>
                            </tr>
                            <tr>

                                <td class="tdr">
                                    <input class="easyui-textbox" name="windupFh" id="windupFh"
                                           data-options="validType:['intOrFloat','maxValue']"/>FH
                                </td>

                            <tr>
                                <td class="tdr">
                                    <input class="easyui-datebox" id="windupDeadline" name="windupDeadline"
                                           style="width:100px;"/>
                                    截止日期
                                </td>
                            </tr>
                        </table>

                    </fieldset>
                    <fieldset class="fieldset_eui" style="float:left;width:76%;height:250px">
                        <p style="font-size: x-small;color: #bb0000">终结文件：(以下任一文件执行后终结该EO)</p>
                        <table id='dg8' style="width:98%;height:95%">
                        </table>
                    </fieldset>

                </div>
            </form>
        </div>
    </div>
</div>
</body>
<script type="text/javascript" src="/js/datagrid_utils.js"></script>
<script type="text/javascript" src="eoEditTl.js"></script>
<link rel="stylesheet" href="/css/datepicker/jquery.ui.all.css">
<script type="text/javascript" src="/js/jquery/jquery.ui.core.js"></script>
<script type="text/javascript" src="/js/jquery/jquery.ui.datepicker.js"></script>
<script type="text/javascript" src="/js/jquery/jquery.ui.widget.js"></script>
<script type="text/javascript">

    //1.最里程操作
    //处理name 需要处理第index个数字值
    function change_name(name,index){
        if(!name) return "";
        var result = name.match(/\[\d+\]/g);
        if(result && result.length!=0){
            result = index==0?result[0]:result[result.length-1];
            result = result.substring(1,result.length-1);
            var position = 0==index?name.indexOf(result):name.lastIndexOf(result);
            return name.substring(0, position) + (parseInt(result) + 1)
                + name.substring(position + result.length);
        }
        return false;
    }


    //最里面的行复制
    function add_query_tr_first(obj){
        var id = $(obj).attr('id');
        var _checkbox;
        var ifVi; //是否可变间隔
        var is;
        if(id == 'add'){
            _checkbox = $('#ifFcNote').is(":checked");
            is = _checkbox;
        }else if(id == 'addRc'){
            _checkbox = $('#ifRcNote').is(":checked");
            ifVi = $('#ifVi').is(":checked");
            is = _checkbox || ifVi || !ifCf;
        }
        if(!is){
            var obj_table = $(obj).parent().parent().prev().find("table");
            var firstLast = $(obj).parent().parent().next();
            var node = obj_table.find("tr").last().clone(true);
            firstLast.find("input[type=radio]").attr("style","height:auto");
            firstLast.find("input[type=radio]").next("span").removeAttr("style");
            node.find("input").val("");
            node.find(".doc_type").val('');
            //node.find(".remove_content_td").html("");
            //最后一层最有一个td内容
            $.each(node.find('.remove_content_td input[name$=startingValue]'),function(){
                $(this).hide();
                $(this).parent().html('').append(this);
            });
            //清空Post
            $.each(node.find('.remove_content_td input[name$=isPost]'),function(){
                $(this).prop("checked", false);
                $(this).parent('td').next().hide();
                $(this).parent('td').next().next().hide();
            });
            //清空Since
            $.each(node.find('.remove_content_td input[name$=isSince]'),function(){
                $(this).prop("checked", false);
                $(this).parent('td').next().hide();
            });

			//隐藏搜索
            node.find('[name=eoSearch]').hide();
            //截止日期
            var deadLine = node.find('input[name$=deadLine]');
            deadLine.removeAttr('id').removeAttr('disabled').removeClass();
            deadLine.datepicker({
                dateFormat: 'yy-mm-dd',
                changeMonth: true,
                changeYear: true,
                yearRange: 'c-70:c+5'
            });
            node.find('[name$=deadLine]').hide();
			  
            //更改name
            $.each(node.find('input,select'),function(){
                this.value = '';
                var _name = change_name(this.name,1);
                if(_name){
                    //更改name
                    this.name = _name;
                }
            });


            //清除提示信息
            $(node).find('.errorMessage,.error').html('');
            obj_table.append(node);
            $(".field").height($(".field").height()+29);
            //控制lable项的控制
            $('select[name$=incrementLabel]:first',node).change();
        }
    }

    //最里层行删除
    function del_query_tr_first(obj){
        //var _checkbox = $(obj).parents('tr:eq(4)').find(':checkbox[name$=_control]').attr('checked');
        //if(_checkbox){
        var obj_table = $(obj).parents('table:eq(0)');
        if(obj_table.find("tr").length>1){
            if(!confirm('确定删除?')){
                return;
            }
            //P.$.dialog.confirm("Delete ?",function(){
            $(obj).parents('tr:eq(0)').remove();
            $(".field").height($(".field").height()-29);
            reorder_table_tr_first(obj_table);
            if(obj_table.find("tr").length==1){
                var firstLast = $(obj_table).parents('td:eq(0)').next().next();
                firstLast.find("input[type=radio]").attr("style","height:auto;display:none");
                firstLast.find("input[type=radio]").removeAttr("checked");
                firstLast.find("input[type=radio]").next("span").attr("style","display:none");
            }
            //控制lable项的控制
            $('tr:first select[name$=incrementLabel]:first',obj_table).change();
            //});
        }
        //}
    }

    //重新排序最里层的name值
    function reorder_table_tr_first(table){
        //获取当前table剩余的行数
        var tableLength = table.children().children().length;
        for(var i = 0;i < tableLength; i++){
            //更改每行中的name值
            $.each(table.children().children("tr:eq("+i+")").find('input,select'),function(){
                if(this.name){
                    var _name = "";
                    var result = this.name.match(/\[\d+\]/g);
                    if(result && result.length!=0){
                        result = result[result.length-1];
                        result = result.substring(1,result.length-1);
                        var position = this.name.lastIndexOf(result);
                        _name = this.name.substring(0, position) + i + this.name.substring(position + result.length);
                    }
                    if(_name){
                        //更改name
                        this.name = _name;
                    }
                }
            });
        }
    }

    //更改startingLabel时更改startingValue
    function value_change_first(obj){
        var obj_value = $(obj).val();
        var name = $(obj).attr('name');
        var find_td = $(obj).parent().next();
        _change(obj_value,find_td, name);
    }
    //改变startingValue的内容
    function _change(obj_value,find_td, name){
        //获取默认input
        var _input;
        var appendDateName = '';
        var flag = '1'; //首/重检单位标志
        if(name && name.indexOf('postType') != -1){
            var subName1 = name.substr(0, name.lastIndexOf('.'));
            appendDateName = subName1 + "." + "post";
            _input = find_td.find('input[name$=post]');
            _input.removeAttr('readonly').removeClass('no_edit').css('width', '150px').val('');
        }else if(name && ((name.indexOf('startingLabel') != -1)
            || (name.indexOf('rcStartingLabel') != -1))){
            flag = '0';
            var subName2 = name.substr(0, name.lastIndexOf('.'));
            appendDateName = subName2 + "." + "startingValue";
            _input = find_td.find('input[name$=startingValue]');
            _input.removeAttr('readonly').removeClass('no_edit').css('width', '90px').val('');
        }else if(name && name.indexOf('sinceType') != -1){ //sinceType
            flag = '2';
            _input = find_td.find('input[name$=deadLine]');
            _input.removeAttr('readonly').removeClass('no_edit').css('width', '150px').val('');
        }

        if(_input){
            find_td.html(""); //清空td
            if(obj_value == 'DATE'){
                _input.removeAttr('id').removeClass();
                _input.removeAttr('disabled');
                _input.datepicker({
                    dateFormat: 'yy-mm-dd',
                    changeMonth: true,
                    changeYear: true,
                    yearRange: 'c-70:c+5'
                });
                _input.attr('readonly', 'readonly');
                /*find_td.append("<input type='text' class='date_text' name='"+appendDateName+"'/>");
                find_td.find('.date_text').datebox({
                    onSelect:function(value){
                        //设置value值
                        if(name && name.indexOf('postType') != -1){
                            $(this).nextAll('input[name$=post]').val($(this).parent().find('.combo-value').val());
                        }else if(name && (name.indexOf('startingLabel') != -1 || name.indexOf('rcStartingLabel') != -1)){
                            $(this).nextAll('input[name$=startingValue]').val($(this).parent().find('.combo-value').val());
                        }
                        //触发校验
                        //check_optional($(this).nextAll('input[name$=startingValue]')[0]);
                    }
                });*/
                find_td.append(_input.show());
                //禁止since,不禁止post
                if(flag == '0'){
                    var applyType = param.applyType;

                    var isPostNode = find_td.parent('tr').find('input[name$=isPost]');
                    isPostNode.removeAttr('disabled');
                    isPostNode.prop('checked', false);
                    postClick(isPostNode);
                    //if(applyType != 'ENG'){ //时间20191015
                        var startValue = find_td.parent('tr').find('input[name$=startingValue]');
                        startValue.attr('disabled', 'disabled');
                        startValue.parent('td').hide();
                        isPostNode.parent('td').hide();
                        var postNode = isPostNode.parent('td').next().next();
                        postNode.show();
                        var post = postNode.find('input');
                        post.removeAttr('id').removeClass();
                        post.removeAttr('disabled');
                        post.datepicker({
                            dateFormat: 'yy-mm-dd',
                            changeMonth: true,
                            changeYear: true,
                            yearRange: 'c-70:c+5'
                        });
                        post.attr('readonly', 'readonly');
                    //}

                    //isPostNode.attr('disabled', 'disabled');
					var eoSearchNode = find_td.parent('tr').find('[name=eoSearch]');
                    eoSearchNode.hide();

                    var isSinceNode = find_td.parent('tr').find('input[name$=isSince]');
                    isSinceNode.prop('checked', false);
                    sinceClick(isSinceNode);
                    isSinceNode.attr('disabled', 'disabled');

                    var deadLineNode = find_td.parent('tr').find('[name$=deadLine]');
                    deadLineNode.hide();
                }
				if(flag == '1'){
                    find_td.next().hide();
                }
                if(flag == '2'){
                    find_td.show();
                }
            }else if(obj_value == 'YJJ'){
                _input.val('');
                _input.attr("disabled","disabled");
                find_td.append(_input.show());

                //禁止post和since
                if(flag == '0'){
                    var isPostNode = find_td.parent('tr').find('input[name$=isPost]');
                    isPostNode.prop('checked', false);
                    var applyType = param.applyType;
                    if(applyType != 'ENG'){
                        isPostNode.parent('td').show();
                    }else{
                        isPostNode.parent('td').hide();
                    }
                    //isPostNode.parent('td').show();
                    find_td.show();
                    postClick(isPostNode);
                    isPostNode.attr('disabled', 'disabled');
					var eoSearchNode = find_td.parent('tr').find('[name=eoSearch]');
                    eoSearchNode.hide();

                    var isSinceNode = find_td.parent('tr').find('input[name$=isSince]');
                    isSinceNode.prop('checked', false);
                    sinceClick(isSinceNode);
                    isSinceNode.attr('disabled', 'disabled');
                }
            }else{
                _input.removeAttr("disabled");
                find_td.append(_input.show());

                if(flag == '0'){
                    var isPostNode = find_td.parent('tr').find('input[name$=isPost]');
					var eoSearchNode = find_td.parent('tr').find('[name=eoSearch]');
                    isPostNode.parent('td').show();
                    find_td.show();
					isPostNode.prop('checked', false);
                    postClick(isPostNode);
                    isPostNode.removeAttr('disabled');
					eoSearchNode.hide();

                    var isSinceNode = find_td.parent('tr').find('input[name$=isSince]');
                    isSinceNode.prop('checked', false);
                    isSinceNode.removeAttr('disabled');
                    sinceClick(isSinceNode);

                    var applyType = param.applyType;
                    if(applyType != 'ENG'){
                        isPostNode.parent('td').show();
                    }else{
                        isPostNode.parent('td').hide();
                    }

                    var deadLineNode = find_td.parent('tr').find('[name$=deadLine]');
                    deadLineNode.hide();
                }

                if(flag == '1' && (obj_value == 'PTF' || obj_value == 'OVERHAUL')){
                    _input.attr('disabled', 'disabled');
					find_td.next().hide();		  
                }
                if(flag == '1' && obj_value == 'EO'){
                    find_td.next().show();
                    _input.attr("readonly","readonly");
                    find_td.next().find('a').show();
                }
                if(flag == '2'){
                    find_td.hide();
                }
            }
        }

    }

    //2.第2层操作
    //搜索xx第index次出现的并累加
    function change_name_second(source,target){
        if(!source || !target) return;
        var _index = source.indexOf(target);
        //前半部分
        var _before = source.substring(0,(_index+target.length));
        var _after = source.substring(_before.length);
        var _order = _after.substring(0,_after.indexOf(']'));
        _after = _after.substring(_order.length);
        return _before + (parseInt(_order)+1) + _after;
    }

    //第二层行添加
    function add_query_tr_second(obj){
        var id = $(obj).attr('id');
        var _checkbox;
        var ifVi; //是否可变间隔
        var is;
        if(id == 'add'){
            _checkbox = $('#ifFcNote').is(":checked");
            is = _checkbox;
        }else if(id == 'addRc'){
            _checkbox = $('#ifRcNote').is(":checked");
            ifVi = $('#ifVi').is(":checked");
            is = _checkbox || ifVi || !ifCf;;
        }
        if(!is){
            var obj_table = $(obj).parent().parent().prev().children("table");
            var node = obj_table.children().children().last().clone(true);
            var obj_tr = node.find("table").find("tr");
            var fromNode = $(obj).parents('td:eq(1)').next();
            if(obj_tr.length>1){
                for(var i = 1;i<obj_tr.length;i++){
                    $(obj_tr[i]).remove();
                }
            }
            node.find("input[type!=radio]").val("");
            fromNode.find("input[type=radio]").attr("style","height:auto");
            fromNode.find("input[type=radio]").next("span").removeAttr("style");
            node.find("input[type=radio]").attr("style","height:auto;display:none");
            node.find("input[type=radio]").next("span").attr("style","display:none");
            node.find(".doc_type").val('');
            // node.find(".remove_content_td").html("");
            // node.find("input[type='radio']").removeAttr("checked");
            //设置groupId的_index
            node.find(':radio').removeAttr('checked');
            //设置第一个单选宽选中
            /*$.each(node.find("div:has(ul)"),function(){
                $(this).find('ul:first :radio').attr("checked","checked");
            });*/
            //最后一层最有一个td内容
            $.each(node.find('.remove_content_td input[name$=startingValue]'),function(){
                $(this).hide();
                $(this).parent().html('').append(this);
            });

            //清空Post
            $.each(node.find('.remove_content_td input[name$=isPost]'),function(){
                $(this).prop("checked", false);
                $(this).parent('td').next().hide();
                $(this).parent('td').next().next().hide();
            });
            //清空Since
            $.each(node.find('.remove_content_td input[name$=isSince]'),function(){
                $(this).prop("checked", false);
                $(this).parent('td').next().hide();
            });

            //截止日期
            var deadLine = node.find('input[name$=deadLine]');
            deadLine.removeAttr('id').removeAttr('disabled').removeClass();
            deadLine.datepicker({
                dateFormat: 'yy-mm-dd',
                changeMonth: true,
                changeYear: true,
                yearRange: 'c-70:c+5'
            });
            node.find('[name$=deadLine]').hide();

            //更改name
            $.each(node.find('input,select,a'),function(){
                var _name;
                if(id == 'add'){
                    _name = change_name_second(this.name,'eoSub2[');
                }else if(id == 'addRc'){
                    _name = change_name_second(this.name,'eoSubRc2[');
                }
                if(_name){
                    //更改name
                    this.name = _name;
                }
            });

            //截止日期
            var deadLine = node.find('input[name$=deadLine]');
            deadLine.removeAttr('id').removeAttr('disabled').removeClass();
            deadLine.datepicker({
                dateFormat: 'yy-mm-dd'
            });
            //清除提示信息
            $(node).find('.errorMessage,.error').html('');
            obj_table.append(node);
            $(".field").height($(".field").height()+29);
            //控制label的选择项
            $('select[name$=incrementLabel]:first',node).change();
        }
    }

    //第二层删除
    function del_query_tr_second(obj){
        //var _checkbox = $(obj).parents('tr:eq(3)').find(':checkbox[name$=_control]').attr('checked');
        //if(_checkbox){
        var id = $(obj).attr('id');
        var obj_table = $(obj).parents('table:eq(0)');
        if(obj_table.children().children().length>1){
            if(!confirm('确定删除?')){
                return;
            }
            //P.$.dialog.confirm("Delete ?",function(){
            $(obj).parents('tr:eq(0)').remove();
            if(obj_table.children().children().length ==1){
                //var onlyTr = $(obj).parents('tr:eq(3)').next();
                //var onlyTr = obj_table.parent().parent().parent().parent().parent().parent().children();
                var onlyTr = obj_table.parents('td:eq(1)').next();
                onlyTr.find("input[type=radio]").attr("style","height:auto;display:none").removeAttr("checked");
                onlyTr.find("input[type=radio]").next("span").attr("style","display:none");
            }
            $(".field").height($(".field").height()-29);
            //重新设置第二层表格中的name下标值
            reorder_table_tr_second(obj_table, id);
            //});
        }
        //}
    }
    //重新排序第二层的name值
    function reorder_table_tr_second(table, id){
        //获取当前table剩余的行数
        var tableLength = table.children().children().length;
        for(var i = 0;i < tableLength; i++){
            //更改每行中的name值
            $.each(table.children().children("tr:eq("+i+")").find('input,select'),function(){
                var target;
                if(id=='del'){//首检
                    target = 'eoSub2[';
                }else{
                    target = 'eoSubRc2['
                }
                var source = this.name;
                if(!source || !target) return;
                var _index = source.indexOf(target);
                //前半部分
                var _before = source.substring(0,(_index+target.length));
                var _after = source.substring(_before.length);
                var _order = _after.substring(0,_after.indexOf(']'));
                _after = _after.substring(_order.length);
                var _name = _before + i + _after;
                if(_name){
                    //更改name
                    this.name = _name;
                }
            });
        }
    }


    //保存首检
    function saveFC() {
		var msg = '';			 
        if(!param.pkid){
            MsgAlert({content : '请先保存时限分组', type : 'error'});
            return;
        }
        var fcData = '';
        var ifSetIl = '';
        var initialLead = '';
        var is = $('#ifFcNote').is(':checked');
        if(is){
            fcData = $('#fcNote').val();
        }else{
            ifSetIl = $('#ifSetIl').combobox('getValue');
            initialLead = $('#initialLead').textbox('getValue');

            var obj = [];
            var bgFristLast = $('[name="vo.complianceTimes[0].eoSub1[0].firstLast"]:checked').val();
            //首检小组的个数
            var fgNode = $("[name='fcSgTr']");
            var sgLen = fgNode.length;

            if(sgLen > 1 && ifSetIl && ifSetIl == 'Y'){
                msg += '是否提前量为是，只允许有且仅有一个FC或FH的首检值';
                return msg;
            }

            if(sgLen > 1 && !bgFristLast){
                //MsgAlert({content : '请选择大组原则', type : 'error'});
				msg += '请选择首检大组原则';
                return msg;
            }
            var sgParam = [];
            var fcUnits = []; //保存首检单位，用于验证首检单位是否重复
            for (var i = 0; i < sgLen; i++) {
                var sgFirstLastV = $("[name='vo.complianceTimes[0].eoSub1[0].eoSub2[" + i + "].firstLast']:checked").val();
                //首检小组对应的首检值个数
                var sgFirstLast = $("[name='vo.complianceTimes[0].eoSub1[0].eoSub2[" + i + "].firstLast']");
                var node = sgFirstLast.parent().parent().parent().parent().prev().prev().children();
                var vLen = node.find('tr').length;
                if(vLen > 1 && ifSetIl && ifSetIl == 'Y'){
                    msg += '是否提前量为是，只允许有且仅有一个FC或FH的首检值';
                    return msg;
                }
                if(vLen > 1 && !sgFirstLastV){
                    //MsgAlert({content : '请选择小组原则', type : 'error'});
					msg += '请选择首检小组原则';
                    return msg;
                }
                var vParams = [];
                for (var j = 0; j < vLen; j++) {
                    var fcUnit = $("[name='vo.complianceTimes[0].eoSub1[0].eoSub2[" + i + "].eoSub3[" + j + "].startingLabel']").val();
                    if(!fcUnit){
                        //MsgAlert({content : '请选择首检单位', type : 'error'});
						msg += '请选择首检单位';
                        return msg;
                    }
                    if(fcUnit != 'FC' && fcUnit != 'FH' && ifSetIl && ifSetIl == 'Y'){
                        msg += '是否提前量为是，只允许有且仅有一个FC或FH的首检值';
                        return msg;
                    }
                    var fcV = $("[name='vo.complianceTimes[0].eoSub1[0].eoSub2[" + i + "].eoSub3[" + j + "].startingValue']").val();
                    if(fcUnit!= 'YJJ' && fcUnit != 'DATE' && !fcV){
                        //MsgAlert({content : '请输入首检值', type : 'error'});
                        msg += '请输入首检值';
                        return msg;
                    }
                    //20191015
                    /*if(fcUnit == 'DATE' && param.applyType == 'ENG' && !fcV){
                        msg += '请输入首检值';
                        return msg;
                    }*/
                    if(fcUnit != 'YJJ' && fcUnit != 'DATE' && fcV){
                        var reg = /^[1-9]\d*$/;
                        if(!reg.test(fcV) || fcV > 999999){
                            //MsgAlert({content: '首检值为1~999999的整数', type: 'error'});
							msg += '首检值为1~999999的整数';
                            return msg;
                        }
                    }

                    fcUnits.push(fcUnit);
                    //20191015
                    //if(fcUnit == 'DATE' && param.applyType != 'ENG'){
                    if(fcUnit == 'DATE'){
                        $("[name='vo.complianceTimes[0].eoSub1[0].eoSub2[" + i + "].eoSub3[" + j + "].isPost']").prop("checked",true);
                        $("[name='vo.complianceTimes[0].eoSub1[0].eoSub2[" + i + "].eoSub3[" + j + "].postType']").val('DATE');
                    }

                    var ifPost = $("[name='vo.complianceTimes[0].eoSub1[0].eoSub2[" + i + "].eoSub3[" + j + "].isPost']").is(':checked')? 'Y':'N';
                    var postFileType = $("[name='vo.complianceTimes[0].eoSub1[0].eoSub2[" + i + "].eoSub3[" + j + "].postType']").val();
                    var postFileNo = '';
                    var postDate = '';
                    //if(fcUnit == 'DATE' && param.applyType != 'ENG'){
                    if(fcUnit == 'DATE'){
                        if(!postFileType || 'DATE' != postFileType){
                            msg += '首检单位为DATE类型，POST类型必须为DATE类型';
                            return msg;
                        }
                    }
                    if(!postFileType && ifPost && ifPost == 'Y'){
                        //MsgAlert({content : '请输选择POST类型', type : 'error'});
						msg += '请输选择POST类型';
                        return msg;
                    }
                    if(postFileType && ifPost && ifPost == 'Y'){
                        if(postFileType == 'DATE'){
                            postDate = $("[name='vo.complianceTimes[0].eoSub1[0].eoSub2[" + i + "].eoSub3[" + j + "].post']").val();
                            if(!postDate){
                                //MsgAlert({content : '请输入POST值', type : 'error'});
						        msg += '请输入POST值';
                                return msg;
                              
                            }
                        }else if(postFileType == 'EO'){
                            postFileNo = $("[name='vo.complianceTimes[0].eoSub1[0].eoSub2[" + i + "].eoSub3[" + j + "].post']").val();
                            if(!postFileNo){
                                //MsgAlert({content : '请输入POST值', type : 'error'});
								msg += '请输入POST值';
                                return msg;
                            }
                        }
                    }else{
                        postDate = '';
                        postFileNo = '';
                    }
                    var ifSince = $("[name='vo.complianceTimes[0].eoSub1[0].eoSub2[" + i + "].eoSub3[" + j + "].isSince']:checked").is(':checked')? 'Y':'N';
                    var sinceType = $("[name='vo.complianceTimes[0].eoSub1[0].eoSub2[" + i + "].eoSub3[" + j + "].sinceType']").val();
                    if(ifSince && ifSince == 'Y' && !sinceType){
                        //MsgAlert({content : '请输入SINCE类型', type : 'error'});
						msg += '请输入SINCE类型';
                        return msg;
                    }
                    var deadLine = $("[name='vo.complianceTimes[0].eoSub1[0].eoSub2[" + i + "].eoSub3[" + j + "].deadLine']").val();
                    if(ifSince && ifSince == 'Y' && sinceType && sinceType=='DATE' && !deadLine){
                        //MsgAlert({content : '请输入SINCE类型', type : 'error'});
                        msg += '请选择SINCE DATE类型的日期';
                        return msg;
                    }
                    vParams.push({'ID': j + 1, 'fcUnit': fcUnit, 'fcV': fcV, ifPost: ifPost, postFileType: postFileType,postFileNo:postFileNo,
                        postDate:postDate,ifSince:ifSince,sinceType:sinceType,deadLine:deadLine});
                }

                sgParam.push({'ID': i + 1, 'PRINCPLE': sgFirstLastV, 'VALUE_DATA': vParams})
            }

            //首检单位重复检验
            /*var unitFlag = checkUnit(fcUnits);
            if(unitFlag){
                //MsgAlert({content: '首检单位不可重复', type: 'error'});
				msg += '首检单位不可重复';
                return msg;
            }*/

            //维护提前量首检单位只能是FH,FC,DY
            /*var ifSetTlFlag = false;
            if(ifSetIl && ifSetIl == 'Y' && initialLead){
                for(var i=0; i<fcUnits.length; i++){
                    if(fcUnits[i] != 'FH' &&  fcUnits[i] != 'FC' && fcUnits[i] != 'DY'){
                        ifSetTlFlag = true;
                        break;
                    }
                }
            }
            if(ifSetTlFlag){
                msg += '维护提前量，首检单位只能是FH,FC,DY';
                return msg;
            }*/

            if(ifSetIl && ifSetIl == 'Y' && !initialLead){
                //MsgAlert({content : '请输入提前量', type : 'error'});
                msg += '请输入提前量\n';
                return msg;
            }
            if(ifSetIl && ifSetIl == 'Y' && initialLead){
                var reg = /^[1-9]\d*$/;
                if(!reg.test(initialLead) || initialLead > 99){
                    //MsgAlert({content: '提前量为正整数', type: 'error'});
                    msg += '提前量为1-100的正整数';
                    return msg;
                }
            }

            obj.push({'ID': 1, 'PRINCPLE': bgFristLast, 'SG_DATA': sgParam});
            fcData = JSONstringify(obj);
        }

        InitFuncCodeRequest_({
            data: {
                pkid: param.pkid, fcData: fcData, noteFlag: is, ifSetIl : ifSetIl,
                initialLead: initialLead,
                FunctionCode: "EM_EO_TLIMIT_ADD_FC"
            },
            async: false,
            successCallBack: function (jdata) {
                if (jdata.code == RESULT_CODE.SUCCESS_CODE) {
                    param.OWindow.reload_("#dg1");
                    //MsgAlert({content: jdata.msg ? jdata.msg : $.i18n.t('msg_tip:TIP.COMMON.OPT_SUCCESS')});
                } else {
                    MsgAlert({content: jdata.msg, type: 'error'});
                }
            }
        });
    }

    //保存重检
    function saveRC() {
		var msg = '';											
        if(!param.pkid){
            MsgAlert({content : '请先保存时限分组', type : 'error'});
            return;
        }
        var ifVi = $('#ifVi').is(':checked');
        if(ifVi){
            MsgAlert({content : '已选中是否可变间隔，不支持此操作', type : 'error'});
            return;
        }
        var rcData = '';
        var is = $('#ifRcNote').is(':checked');
        if(is){
            rcData = $("#rcNote").val();
        }else{
            var obj = [];
            var bgFristLast = $('[name="vo.complianceTimes[0].eoSubRc1[0].firstLast"]:checked').val();
            //重检小组的个数
            var fgNode = $("[name='rcSgTr']");
            var sgLen = fgNode.length;
            if(sgLen > 1 && !bgFristLast){
                //MsgAlert({content : '请选择大组原则', type : 'error'});
				msg += '请选择重检大组原则';
                return msg;
            }
            var sgParam = [];
            var rcUnits = [];
            for (var i = 0; i < sgLen; i++) {
                var sgFirstLastV = $("[name='vo.complianceTimes[0].eoSubRc1[0].eoSubRc2[" + i + "].firstLast']:checked").val();
                //重检小组对应的重检值个数
                var sgFirstLast = $("[name='vo.complianceTimes[0].eoSubRc1[0].eoSubRc2[" + i + "].firstLast']");
                var node = sgFirstLast.parent().parent().parent().parent().prev().prev().children();
                var vLen = node.find('tr').length;
                if(vLen > 1 && !sgFirstLastV){
                    //MsgAlert({content : '请选择小组原则', type : 'error'});
					msg += '请选择重检小组原则';
                    return msg;
                }
                var vParams = [];
                for (var j = 0; j < vLen; j++) {
                    var rcUnit = $("[name='vo.complianceTimes[0].eoSubRc1[0].eoSubRc2[" + i + "].eoSubRc3[" + j + "].rcStartingLabel']").val();
                    if(!rcUnit){
                        //MsgAlert({content : '请选择重检单位', type : 'error'});
						msg += '请选择重检单位';
                        return msg;
                    }
                    var rcV = $("[name='vo.complianceTimes[0].eoSubRc1[0].eoSubRc2[" + i + "].eoSubRc3[" + j + "].startingValue']").val();
                    if(!rcV){
                        //MsgAlert({content: '请输入重检值', type: 'error'});
						msg += '请输入重检值';
                        return msg;
                    }else{
                        var reg = /^[1-9]\d*$/;
                        if(!reg.test(rcV) || rcV > 999999){
                            //MsgAlert({content: '首检值为1~999999的整数', type: 'error'});
							msg += '首检值为1~999999的整数';
                            return msg;
                        }
                    }

                    rcUnits.push(rcUnit);

                    var ifSince = $("[name='vo.complianceTimes[0].eoSubRc1[0].eoSubRc2[" + i + "].eoSubRc3[" + j + "].isSince']:checked").is(':checked')? 'Y':'N';
                    var sinceType = $("[name='vo.complianceTimes[0].eoSubRc1[0].eoSubRc2[" + i + "].eoSubRc3[" + j + "].sinceType']").val();
                    if(ifSince && ifSince == 'Y' && !sinceType){
                        //MsgAlert({content : '请输入SINCE类型', type : 'error'});
						msg += '请输入SINCE类型';
                        return msg;
                    }
                    var deadLine = $("[name='vo.complianceTimes[0].eoSubRc1[0].eoSubRc2[" + i + "].eoSubRc3[" + j + "].deadLine']").val();
                    vParams.push({'ID': j + 1, 'rcUnit': rcUnit, 'rcV': rcV, ifSince:ifSince,sinceType:sinceType,deadLine:deadLine});
                }
                sgParam.push({'ID': i + 1, 'PRINCPLE': sgFirstLastV, 'VALUE_DATA': vParams})
            }

            //重检单位重复校验
            var rcUnitFlag = checkUnit(rcUnits);
            if(rcUnitFlag){
                //MsgAlert({content: '重检单位不可重复', type: 'error'});
				msg += '重检单位不可重复';
                return msg;
            }

            obj.push({'ID': 1, 'PRINCPLE': bgFristLast, 'SG_DATA': sgParam});
            rcData = JSONstringify(obj);
        }

        InitFuncCodeRequest_({
            data: {
                pkid: param.pkid, rcData: rcData, noteFlag : is,
                FunctionCode: "EM_EO_TLIMIT_ADD_RC"
            },
            async: false,
            successCallBack: function (jdata) {
                if (jdata.code == RESULT_CODE.SUCCESS_CODE) {
                    param.OWindow.reload_("#dg1");
                    MsgAlert({content: jdata.msg ? jdata.msg : $.i18n.t('msg_tip:TIP.COMMON.OPT_SUCCESS')});
                } else {
                    MsgAlert({content: jdata.msg, type: 'error'});
                }
            }
        });
    }


    //重置时限
    function resetTl(type) {
        if(type == 'rc'){
            var ifVi = $('#ifVi').is(':checked');
            if(ifVi){
                MsgAlert({content : '已选中是否可变间隔，不支持此操作', type : 'error'});
                return;
            }
        }

        if(!confirm('确认重置时限?')){
            return;
        }

        InitFuncCodeRequest_({
            data: {pkid: param.pkid,type: type,FunctionCode: "EM_EO_TLIMIT_RESET_PKID"},
            async: false,
            successCallBack: function (jdata) {
                if (jdata.code == RESULT_CODE.SUCCESS_CODE) {
                    param.OWindow.reload_("#dg1");
                    MsgAlert({content: jdata.msg ? jdata.msg : $.i18n.t('msg_tip:TIP.COMMON.OPT_SUCCESS')});
                } else {
                    MsgAlert({content: jdata.msg, type: 'error'});
                }
            }
        });
        if(type == 'fc'){
            $('#ifFcNote').prop('checked', false);
            appendResetTable(); //清空页面数据
            loadSelect('fc');
        }else if(type == 'rc'){
            $('#ifRcNote').prop('checked', false);
            appendRcResetTable(); //清空页面数据
            loadSelect('rc');
        }
    }

    //POST选择
    function postClick(obj) {
        // debugger;
        var is = $(obj).is(':checked');
        var postTypeNode = $(obj).parent('td').next();
        var postNode = $(obj).parent('td').next().next();
        if(is){
            postTypeNode.show();
            postNode.show();
			postNode.find('a').hide();				  
        }else{
            //清空值
            postTypeNode.hide();
            postNode.hide();
            postTypeNode.children('select').val('');
            postNode.children('input').val('');
        }
    }

    //Since选择
    function sinceClick(obj) {
        var is = $(obj).is(':checked');
        var sinceTypeNode = $(obj).parent('td').next();
        var deadLineNode = $(obj).parent('td').next().next();
        if(is){
            sinceTypeNode.show();
            sinceTypeNode.find('select').show();
            /*deadLineNode.children('input').val('');
            deadLineNode.children('input').attr('disabled', 'disabled');*/
        }else{
            sinceTypeNode.hide();
            sinceTypeNode.children('select').val('');
            var deadLine = deadLineNode.children('input');
            deadLine.val('');
            deadLine.hide();
            /*var deadLine = deadLineNode.children('input');
            deadLine.removeAttr('disabled');
            deadLine.datepicker({
                dateFormat: 'yy-mm-dd'
            })*/
        }
    }

    //判断首/重检单位是否重复
    function checkUnit(units){
        var flag = false;
        var s = units.join(",")+",";
        for(var i=0;i<units.length;i++) {
            if(s.replace(units[i]+",","").indexOf(units[i]+",")>-1) {
                flag = true;
                break;
            }
        }
        return flag;
    }
</script>
</html>