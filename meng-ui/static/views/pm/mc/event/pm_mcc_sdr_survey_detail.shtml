<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head id="i18n_" module="">
  <!--#include virtual="/views/items/resource_.shtml"-->
  <title>使用困难调查报告管理</title>
  <style type="text/css">
    .sdrTable {
      width: 100%;
      border: 1px solid #e7e7e7;
    }

    .sdrTable th{
      width: 80px;
    }

    ul li {
      margin-bottom:4px
    }

    .rowLable {
      font-size: 11px;
      color: #32404b;
      font-weight: bold;
      margin-bottom:5px;
    }

    .surveyInputText{
      width: 100px;
      position: relative;
      border: 1px solid #D4D4D4;
      border-radius: 4px;
      height: 19px;
    }

    .surveyInputText2{
      width: 150px;
      position: relative;
      border: 1px solid #D4D4D4;
      border-radius: 4px;
      height: 19px;
    }
  </style>
  <script type="text/javascript" src="/js/datagrid_utils.js"></script>
  <script type="text/javascript" src="js/sdrSurvey.js"></script>
  <script src="/js/plugins/ajaxfileupload/ajaxfileupload.js" type="text/javascript"></script>
</head>
<body>
<div style="width:95%;margin:0 auto;">
  <div class="ibox-content">
    <form class="form-horizontal m-t" id="mform">
      <div id="p0" class="easyui-panel" title="使用困难报告调查单" style="width: 100%"></div>
      <input type="hidden" name="rev"/>
      <input type="hidden" name="pkid"/>
      <input type="hidden" name="sdrId"/>
      <input type="hidden" name="status"/>
      <input type="hidden" name="inputerName"/>
      <input type="hidden" name="inputerId"/>
      <table class="table table-bordered table-info">
        <!-- 按钮行 -->
        <tr>
          <td align="right" style="padding: 10px;">
            <a class="searchBtn" type="button" onclick="saveOrUpdate()" id="saveButton"
               data-options="iconCls:'icon-save'"><span>保存</span></a>&nbsp;&nbsp;
            <a class="searchBtn" type="button" onclick="submitFlow()" id="submitFlowButton"
               data-options="iconCls:'icon-save'"><span>提交</span></a>&nbsp;&nbsp;
            <a class="searchBtn" type="button" onclick="closeWindow()"
               data-options="iconCls:'icon-close'"><span>关闭</span></a>&nbsp;&nbsp;
          </td>
        </tr>
      </table>
      <table class="table table-bordered table-info">
        <!-- 一、困难报告主要信息-->
        <tr>
          <td colspan="2">
            <table class="table table-bordered table-info sdrTable">
              <tr>
                <th class="th" style="width:140px;height:30px">1.航空器注册号/型号：</th>
                <td style="width:180px"><input class="easyui-textbox" name="acno" id="acno"
                           data-options="required:true,editable:false"/></td>
                <td rowspan="2" style="width:50%;text-align:center;">
                  <label style="font-size:22px;">使用困难报告调查单</label><br/>
                </td>
                <th class="th" style="text-align:center;background-color: #F5F5F6;">3.调查单编号：</th>
              </tr>
              <tr>
                <th style="height:30px">2.航空运营人：</th>
                <td class="tdr hs">顺丰航空有限公司</td>
                <td style="text-align:center;"><input class="easyui-textbox" name="surveyNo" id="surveyNo"
                                                      data-options="editable:false"/></td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
          <th class="th" style="width:100px" nowrap>4.使用困难报告内容核实：</th>
          <td>
            <table class="table table-bordered table-info" style="height:200px;">
              <tr>
                <th class="th">SDR编号:</th>
                <td class="td5"><input class="easyui-textbox" name="sdrNo" id="sdrNo"
                                       data-options="editable:false"/></td>
                <th class="th">航班代码:</th>
                <td class="td5">
                  <input class="easyui-textbox" name="flightNo" id="flightNo"
                         data-options="editable:false"/>
                </td>
                <th class="th">发生日期:</th>
                <td class="td5"><input class="easyui-textbox" name="sdrDate" id="sdrDate"
                                       data-options="editable:false"/>
                </td>
                <th class="th">发生地点:</th>
                <td class="td5">
                  <input class="easyui-textbox" name="sdrPlace" id="sdrPlace" data-options="editable:false"/>
                </td>
              </tr>
              <tr>
                <th class="th">发生阶段:</th>
                <td class="td5"><input class="easyui-combobox" name="sdrStage" id="sdrStage"
                                       data-options="readonly:true"/></td>
                <th class="th">故障现象:</th>
                <td class="td5"><input class="easyui-combobox" name="sdrAppear" id="sdrAppear"
                                       data-options="readonly:true"/></td>
                <th class="th" style="width:90px">预防/紧急措施:</th>
                <td class="td5"><input class="easyui-combobox" name="sdrMeasure" id="sdrMeasure"
                                       data-options="readonly:true"/></td>
                <th class="th">涉及主要系统:</th>
                <td class="td5"><input class="easyui-textbox" name="sdrAta" id="sdrAta"
                                       data-options="editable:false"/></td>
              </tr>
              <tr>
                <th colspan="8" style="text-align:left;">&nbsp;事件描述和纠正措施：</th>
              </tr>
              <tr>
                <td class="td5" colspan="8" style="padding-left:2px">
                  <input class="easyui-textbox" style="width:99%;height:100px;" name="sdrDes" id="sdrDes"
                         data-options="multiline:true,editable:false"/>
                </td>
              </tr>
              <tr style="display:none">
                <td class="td5" colspan="8">
                  <input type="file" name="sdrFile" id="sdrFile"/>
                  <input type="button" id="sdrFileBtn"/>
                  <span id="sdrUploadedFiles"></span>
                </td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
          <th class="th">5.航空器系统/部件通用代码：</th>
          <td class="tdr hs">
            <input class="easyui-textbox" name="ataNo1" id="ataNo1" data-options="validType:['maxLength[3]']"
                   style="margin-left:15px;width:120px"/>
            <input class="easyui-textbox" name="ataNo2" id="ataNo2" data-options="validType:['maxLength[3]']"
                   style="margin-left:15px;width:120px"/>
            <input class="easyui-textbox" name="ataNo3" id="ataNo3" data-options="validType:['maxLength[3]']"
                   style="margin-left:15px;width:120px"/>
            <input class="easyui-textbox" name="ataNo4" id="ataNo4" data-options="validType:['maxLength[3]']"
                   style="margin-left:15px;width:120px"/>
          </td>
        </tr>
      </table>
      <table class="table table-bordered table-info">
        <tr>
          <th class="th" style="width:100px" nowrap>6.涉及的主要设备：</th>
          <td>
            <table id="equipmentTable" style="height:auto" class="table table-bordered table-info">
              <tr>
                <th class="tdl" style="width: 100px;">当前附件：</th>
                <td colspan="6">
                  <div id="attachesUl"></div>
                </td>
              </tr>
              <tr style="text-align:center">
                <th class="th" style="text-align:center"></th>
                <th class="th" style="text-align:center">制造厂</th>
                <th class="th" style="text-align:center">型号</th>
                <th class="th" style="text-align:center">序号</th>
                <th class="th" style="text-align:center">总使用时间</th>
                <th class="th" style="text-align:center">总使用循环</th>
                <th class="th" style="width: 430px;"></th>
              </tr>
              <tr class="equipRow" rowIndex="1">
                <input type="hidden" name="equipPkid"/>
                <td class="tdr hs">
                  <!--<input class="easyui-combobox" name="eqpType" id="eqpType1" data-options="width:'150px'"/>-->
                  <select name="eqpType" onchange="getEquipment(this)"
                          style="width:100px;border-color:#D4D4D4;border-radius: 4px;">
                      <option value=""></option>
                    <option value="1">飞机</option>
                    <option value="2">发动机1</option>
                    <option value="3">发动机2</option>
                    <option value="4">发动机3</option>
                    <option value="5">发动机4</option>
                    <option value="6">辅助动力</option>
                  </select>
                </td>
                <td class="tdr hs">
                    <input type="text" name="manufacturer" data-options="validType:['maxLength[30]']" class="surveyInputText"/>
                </td>
                <td class="tdr hs">
                    <input type="text" data-options="validType:['maxLength[60]']" name="model" class="surveyInputText"/>
                </td>
                <td class="tdr hs">
                    <input type="text" data-options="validType:['maxLength[60]']" name="sn" class="surveyInputText"/>
                </td>
                <td class="tdr hs">
                    <input type="text" data-options="validType:['maxLength[60]']" name="tfh" class="surveyInputText"/>
                </td>
                <td class="tdr hs">
                    <input type="text" data-options="validType:['maxLength[60]']" name="tfc" class="surveyInputText"/>
                </td>
                <td>
                  <input type="file" style="margin-right:10px;border: 1px solid #D4D4D4;width:280px;border-radius: 4px;"
                         id="equipFileInput_0" name="file"/>
                  <span style="width:100px"></span>
                  <a href="#" class="easyui-linkbutton" data-options="iconCls:'icon-ok'" type="eqpButton"
                     onclick="uploadEqpFile(this)">upload</a>
                  <a href="#" class="easyui-linkbutton" data-options="iconCls:'icon-remove'" type="eqpButton"
                     onclick="removeEqpRow(this)"></a>
                  <a href="#" class="easyui-linkbutton" data-options="iconCls:'icon-add'" type="eqpButton"
                     onclick="addEqpRow(this)"></a>
                </td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
      <!--7.故障零件/结构缺陷情况：-->
      <table class="table table-bordered table-info">
        <tr>
          <th class="th" style="width:100px">7.故障零件/结构缺陷情况：</th>
          <td id="flawTd">
            <table class="table table-bordered table-info" style="height:135px;margin-bottom:15px" name="flawTable">
              <input type="hidden" name="sdrFlawPkid"/>
              <tr>
                <th style="text-align:center;width:80px">(a)名称</th>
                <th style="text-align:center">(b)制造厂家</th>
                <th style="text-align:center">(c)件号</th>
                <th style="text-align:center">(d)序号</th>
                <th style="text-align:center">(e)状况</th>
                <th style="text-align:center">(f)故障件或缺陷位置</th>
                <th rowspan="4" style="text-align:center">
                  <a href="#" class="easyui-linkbutton" data-options="iconCls:'icon-add'" type="flawButton"
                     onclick="addFlawRow(this)">Add</a>
                  <a href="#" class="easyui-linkbutton" data-options="iconCls:'icon-remove'" type="flawButton"
                     onclick="removeFlawRow(this)">DEL</a>
                </th>
              </tr>
              <tr align="center">
                  <td><input type="text" name="pnName" id="pnName" data-options="validType:['maxLength[300]']" class="surveyInputText2"/></td>
                  <td><input type="text" name="pnMan" id="pnMan" data-options="validType:['maxLength[30]']" class="surveyInputText2"/></td>
                  <td><input type="text" name="pn" id="pn" data-options="validType:['maxLength[60]']" onblur="getflaw(this,'pn')"
                             class="surveyInputText2"/></td>
                  <td><input type="text" name="sn" id="sn" data-options="validType:['maxLength[60]']" onblur="getflaw(this,'sn')"
                             class="surveyInputText2"/></td>
                  <td><input type="text" name="des" id="des" data-options="validType:['maxLength[120]']" class="surveyInputText2"/></td>
                  <td><input type="text" name="location" id="location" data-options="validType:['maxLength[60]']" class="surveyInputText2"/></td>
              </tr>
              <tr>
                <th style="text-align:center;width:80px">(g)发现途径</th>
                <th style="text-align:center">(h)总时间</th>
                <th style="text-align:center">(i)总循环</th>
                <th style="text-align:center">(j)上次修理单位</th>
                <th style="text-align:center">(k)修后时间</th>
                <th style="text-align:center">(l)修后循环</th>
              </tr>
              <tr align="center">
                  <td rowspan="2"><input type="text" name="find" id="find" data-options="validType:['maxLength[210]']" class="surveyInputText2"/></td>
                  <td rowspan="2"><input type="text" name="tfh" id="tfh" data-options="validType:['maxLength[60]']" class="surveyInputText2"/></td>
                  <td rowspan="2"><input type="text" name="tfc" id="tfc" data-options="validType:['maxLength[60]']" class="surveyInputText2"/></td>
                  <td><input type="text" name="lastUnit" id="lastUnit" data-options="validType:['maxLength[60]']" disabled class="surveyInputText2"/>
                  </td>
                  <td><input type="text" name="lastFh" id="lastFh" data-options="validType:['maxLength[60]']" disabled class="surveyInputText2"/></td>
                  <td><input type="text" name="lastFc" id="lastFc" data-options="validType:['maxLength[60]']" disabled class="surveyInputText2"/></td>
              </tr>
              <tr>
                <td colspan="4" style="padding-left:10px">
                  <input type="checkbox" name="fOverhaul" value="Y" disabled/>大修&nbsp;&nbsp;&nbsp;&nbsp;
                  <input type="checkbox" name="fRepair" value="Y" disabled/>修理&nbsp;&nbsp;&nbsp;&nbsp;
                  <input type="checkbox" name="fCheck" value="Y" disabled/>检查&nbsp;&nbsp;&nbsp;&nbsp;
                  <input type="checkbox" name="fMod" value="Y" disabled/>改装&nbsp;&nbsp;&nbsp;&nbsp;
                </td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
      <table class="table table-bordered table-info">
        <tr>
          <th class="th" style="width:100px;height:30px">8.故障原因类别</th>
          <td style="padding-left:10px">
            <input class="easyui-combobox" name="isMachine" data-options="required:true,editable:false" id="isMachine"/>
            <span id="nomachineTypeSpan" style="display:none;margin-left:20px">
              <input type="radio" name="nomachineType" value="1"/>维修差错&nbsp;&nbsp;&nbsp;&nbsp;
              <input type="radio" name="nomachineType" value="2"/>地面碰撞&nbsp;&nbsp;&nbsp;&nbsp;
              <input type="radio" name="nomachineType" value="3"/>鸟击&nbsp;&nbsp;&nbsp;&nbsp;
              <input type="radio" name="nomachineType" value="4"/>天气&nbsp;&nbsp;&nbsp;&nbsp;
              <input type="radio" name="nomachineType" value="5"/>外物损伤&nbsp;&nbsp;&nbsp;&nbsp;
              <input type="radio" name="nomachineType" value="6"/>其他&nbsp;&nbsp;&nbsp;&nbsp;
            </span>
          </td>
        </tr>

        <tr>
          <td colspan="2">
            <div class="rowLable" style="margin-bottom:10px;">&nbsp;&nbsp;9.机械类原因的故障情况分析：</div>
            <div style="margin-left:35px">
              <ul>
                <li>
                  1.故障件是否已经确认？&nbsp;&nbsp;&nbsp;&nbsp;
                  <input type="radio" name="isConfirm" value="Y"/>是
                  <input type="radio" name="isConfirm" value="N" checked/>否&nbsp;&nbsp;&nbsp;&nbsp;(TMC填写)<br/>
                  如果是，请简述故障件的故障现象或失效模式；如果否，请回答第（8）条的内容。<br/>
                  <input class="easyui-textbox" name="deferDes" id="deferDes"
                         data-options="validType:['maxLength[1000]'],multiline:true,editable:false" style="height:80px;width:99%"/>
                </li>
                <li>
                  2.相关部件（包括故障件、更换件）是否需要送出测试或修理？&nbsp;&nbsp;&nbsp;&nbsp;
                  <input type="radio" name="isCheck" value="Y"/>是
                  <input type="radio" name="isCheck" value="N" checked/>否&nbsp;&nbsp;&nbsp;&nbsp;(TMC填写)<br/>
                  如果是，请说明测试/修理的内容和结果：<br/>
                  <input class="easyui-textbox" name="checkDes" id="checkDes"
                         data-options="validType:['maxLength[1000]'],multiline:true,editable:false,onlyview:true,prompt:'QA填写'"
                         style="height:80px;width:99%"/>
                </li>
                <li>
                  3.故障件在维修方案中是否有检查项目？&nbsp;&nbsp;&nbsp;&nbsp;
                  <input type="radio" name="isMp" value="Y"/>是
                  <input type="radio" name="isMp" value="N"/>否&nbsp;&nbsp;&nbsp;&nbsp;(可靠性填写)<br/>
                  如果是，请简要说明检查内容和间隔：<br/>
                  <input class="easyui-textbox" name="mpDes" id="mpDes"
                         data-options="validType:['maxLength[1000]'],multiline:true,editable:false,onlyview:true,prompt:'可靠性填写'"
                         style="height:80px;width:99%"/>
                </li>
                <li>
                  4.故障件或系统近期是否做过修理、改装、检查或测试工作？&nbsp;&nbsp;&nbsp;&nbsp;
                  <input type="radio" name="recentWork" value="Y"/>是
                  <input type="radio" name="recentWork" value="N"/>否&nbsp;&nbsp;&nbsp;&nbsp;(可靠性填写)<br/>
                  如果是，请简要说明修理/改装/检查/测试的工作内容：<br/>
                  <input class="easyui-textbox" name="workDes" id="workDes"
                         data-options="validType:['maxLength[1000]'],multiline:true,editable:false,onlyview:true,prompt:'可靠性填写'"
                         style="height:80px;width:99%"/>
                </li>
                <li>
                  5.飞机部件或系统的故障是否与近期的维修工作（修理、改装、检查或测试）相关？&nbsp;&nbsp;&nbsp;&nbsp;
                  <input type="radio" name="relatedWork" value="Y"/>是
                  <input type="radio" name="relatedWork" value="N" checked/>否&nbsp;&nbsp;&nbsp;&nbsp;(TMC填写)<br/>
                  如果是，请说明原因：<br/>
                  <input class="easyui-textbox" name="relatedReason" id="relatedReason"
                         data-options="validType:['maxLength[1000]'],multiline:true,editable:false" style="height:80px;width:99%"/>
                </li>
                <li>
                  6.部件或系统故障是否与厂家资料和服务通告的执行情况有关？&nbsp;&nbsp;&nbsp;&nbsp;
                  <input type="radio" name="relatedSb" value="Y"/>是
                  <input type="radio" name="relatedSb" value="N"/>否&nbsp;&nbsp;&nbsp;&nbsp;(可靠性填写)<br/>
                  如果是，请简要说明制造厂家、资料名称、服务通告号、主要内容和工作执行情况：<br/>
                  <input class="easyui-textbox" name="relatedDes" id="relatedDes"
                         data-options="validType:['maxLength[1000]'],multiline:true,editable:false,onlyview:true,prompt:'可靠性填写'"
                         style="height:80px;width:99%"/>
                </li>
                <li>
                  7.该类故障是否曾经发生过？&nbsp;&nbsp;&nbsp;&nbsp;
                  <input type="radio" name="historyOccur" value="Y"/>是
                  <input type="radio" name="historyOccur" value="N"/>否&nbsp;&nbsp;&nbsp;&nbsp;(可靠性填写)<br/>
                  如果是，请简要说明发生的次数和历次发生事件的描述：<br/>
                  <input class="easyui-textbox" name="historyDes" id="historyDes"
                         data-options="validType:['maxLength[1000]'],multiline:true,editable:false,onlyview:true,prompt:'可靠性填写'"
                         style="height:80px;width:99%"/>
                </li>
                <li>
                  8.如果故障件和系统故障原因无法确认，请按需回答以上（2-7）的问题，并简要说明无法明确故障件或失效系统的原因：&nbsp;&nbsp;&nbsp;&nbsp;(TMC填写)<br/>
                  <input class="easyui-textbox" name="notConfirmReason" id="notConfirmReason"
                         data-options="validType:['maxLength[1000]'],multiline:true" style="height:80px;width:99%"/>
                </li>
                <li>
                  9.如果飞机结构出现腐蚀、开裂、裂纹，请描述腐蚀级别、裂纹长度，修理依据文件、修理方法（简要描述），以及其它同机型是否在同一区域发现同样情况：&nbsp;&nbsp;&nbsp;&nbsp;(可靠性填写)<br/>
                  <input class="easyui-textbox" name="strDes" id="strDes"
                         data-options="validType:['maxLength[1000]'],multiline:true,editable:false,onlyview:true,prompt:'可靠性填写'"
                         style="height:80px;width:99%"/>
                </li>
                <li>
                  10.其它情况说明：（如适用）<br/>
                  <input class="easyui-textbox" name="otherDes" id="otherDes"
                         data-options="validType:['maxLength[1000]'],multiline:true,prompt:'按需填写'" style="height:80px;width:99%"/>
                </li>
              </ul>
            </div>
          </td>
        </tr>

        <tr>
          <td colspan="2">
            <label class="rowLable">&nbsp;&nbsp;10.非机械类原因的情况说明：请简要说明航空器损伤状况和修理情况，对于维修差错事件请说明原因：&nbsp;&nbsp;&nbsp;&nbsp;(QA填写)</label><br/>
            <input class="easyui-textbox" name="notMachineDes" id="notMachineDes"
                   data-options="validType:['maxLength[1000]'],multiline:true,editable:false,onlyview:true,prompt:'QA填写'"
                   style="height:80px;width:99%"/>
          </td>
        </tr>

        <tr>
          <td colspan="2">
            <label class="rowLable">&nbsp;&nbsp;11.预防措施和实施计划或建议（如适用）：</label><br/>
            <input class="easyui-textbox" name="measureDes" id="measureDes"
                   data-options="validType:['maxLength[1000]'],multiline:true,prompt:'按需填写'" style="height:80px;width:99%"/>
          </td>
        </tr>

        <tr>
          <td colspan="2">
            <label class="rowLable">&nbsp;&nbsp;12.其它补充内容：（QA按需填写，可后附文件和图片）</label><br/>
            <input class="easyui-textbox" name="otherContent" id="otherContent"
                   data-options="validType:['maxLength[1000]'],multiline:true,editable:false,onlyview:true,prompt:'QA填写'"
                   style="height:80px;width:99%"/><br/>
            <input type="file" name="file" style="border: 1px solid" id="uploadOtherInput" disabled/>
            <a href="#" class="easyui-linkbutton" id="otherFileUpload" data-options="iconCls:'icon-ok',disabled:true"
               onclick="uploadOtherFile()">upload</a>
            <div id="attachesU2"></div>
          </td>
        </tr>

        <tr>
          <td colspan="2">
            <label class="rowLable">&nbsp;&nbsp;13.本事件是否调查完毕？</label>&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="radio" name="isSurvey" value="Y"/>是
            <input type="radio" name="isSurvey" value="N"/>否&nbsp;&nbsp;&nbsp;&nbsp;(QA填写)<br/>
            如果否，说明原因及调查进度：<br/>
            <input class="easyui-textbox" name="surveyDes" id="surveyDes"
                   data-options="validType:['maxLength[1000]'],multiline:true,editable:false,onlyview:true,prompt:'QA填写'"
                   style="height:80px;width:99%"/>
          </td>
        </tr>

        <tr>
          <td colspan="2">
            <table class="table table-bordered" style="width:100%">
              <tr>
                <td colspan="6">
                  <label class="rowLable">&nbsp;&nbsp;14.局方意见</label><br/>
                  <input class="easyui-textbox" name="caacDes" id="caacDes"
                         data-options="validType:['maxLength[1000]'],multiline:true,editable:false" style="height:80px;width:99%"/><br/>
                </td>
              </tr>
              <tr>
                <th class="th5" style="width:150px">(a)主管机型工程师</th>
                <td>
                  <input class="easyui-textbox" name="engineerName" id="engineerName" data-options="editable:false"/>
                </td>
                <th class="th5" style="width:150px">(b)意见签署日期</th>
                <td>
                    <input class="easyui-datebox" name="issueDate" id="issueDate"
                           data-options="editable:false,onlyview:true"/>
                </td>
                <th class="th5" style="width:150px">(c)要求答复日期</th>
                <td>
                    <input class="easyui-datebox" name="feedbackDate" id="feedbackDate"
                           data-options="editable:false,onlyview:true"/>
                </td>
              </tr>
            </table>
          </td>
        </tr>
        <tr id="editRowButton">
          <td colspan="2" style="text-align:right;padding-right:15px;padding-top:3px;height: 30px;">
            <a class="searchBtn" type="button" onclick="saveOrUpdate()"
               data-options="iconCls:'icon-save'"><span>保存</span></a>&nbsp;&nbsp;
            <a class="searchBtn" type="button" onclick="closeWindow()"
               data-options="iconCls:'icon-close'"><span>关闭</span></a>&nbsp;&nbsp;
          </td>
        </tr>
      </table>
    </form>
  </div>
</div>
</body>
