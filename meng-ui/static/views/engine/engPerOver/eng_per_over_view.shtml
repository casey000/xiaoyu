<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head id="i18n_" module="">
    <!--#include virtual="/views/items/resource_.shtml"-->
    <title>超限报文</title>
    <script type="text/javascript" src="/js/datagrid_utils.js"></script>
    <style type="text/css">
        td {
            padding: 2px;
        }

        button {
            width: 45px;
            height: 20px;
            margin-left: 3px;
            vertical-align: middle;
            border: 1px solid #cfcfcf;
            -moz-border-radius: 5px;
            border-radius: 5px;
            backgroud: #d5d5d5;
        }

        .addBtn {
            padding: 1px 10px;
        }
    </style>
</head>
<body>
<div style="width:95%;margin:0 auto;">
    <div class="ibox float-e-margins">
        <div class="ibox-content">
            <form class="form-horizontal m-t" id="mform">
                <div id="p0" class="easyui-panel" title="超限报文详情" style="width: 100%"></div>
                <input type="hidden" id="pkid" name="pkid"/>
                <table>
                    <tr>
                        <td>
                            <input class="btn btn-primary" type="button" onclick="CloseWindowIframe();" value="关闭"
                                   style="margin-left: 760px"/>
                        </td>
                    </tr>
                </table>

                <div style="width:40%;height:98%;float: left">
                    <table class="table table-bordered table-info" style="width: 100%">
                        <tr>
                            <th style="width: 100px">机号：</th>
                            <td class="tdr">
                                <input class="easyui-textbox" id="an" name="an"
                                       data-options="onlyview:true,editable:false" style="width: 100%;"/>
                            </td>
                        </tr>
                        <tr>
                            <th style="width: 100px">报文日期：</th>
                            <td class="tdr">
                                <input class="easyui-datebox" id="msgDate" name="msgDate"
                                       data-options="onlyview:true,editable:false" style="width: 100%;"/>
                            </td>
                        </tr>
                        <tr>
                            <th style="width: 100px">报文标题：</th>
                            <td class="tdr">
                                <input class="easyui-textbox" id="subtag" name="subtag"
                                       data-options="onlyview:true,editable:false" style="width: 100%;"/>
                            </td>
                        </tr>
                        <tr>
                            <th style="width: 100px">发动机型号：</th>
                            <td class="tdr">
                                <input class="easyui-textbox" id="epn" name="epn"
                                       data-options="onlyview:true,editable:false" style="width: 100%;"/>
                            </td>
                        </tr>
                        <tr>
                            <th style="width: 100px">发动机序号：</th>
                            <td class="tdr">
                                <input class="easyui-textbox" id="esn" name="esn"
                                       data-options="onlyview:true,editable:false" style="width: 100%;"/>
                            </td>
                        </tr>
                        <tr>
                            <th style="width: 100px">飞行阶段：</th>
                            <td class="tdr">
                                <input class="easyui-textbox" id="modes" name="modes"
                                       data-options="onlyview:true,editable:false" style="width: 100%;"/>
                            </td>
                        </tr>
                        <tr>
                            <th style="width: 100px">超限报文事件：</th>
                            <td class="tdr">
                                <input class="easyui-textbox" id="reason" name="reason"
                                       data-options="onlyview:true,editable:false" style="width: 100%;"/>
                            </td>
                        </tr>
                        <tr>
                            <th style="width: 100px">峰值：</th>
                            <td class="tdr">
                                <input class="easyui-textbox" id="peak" name="peak"
                                       data-options="onlyview:true,editable:false" style="width: 100%;"/>
                            </td>
                        </tr>
                        <tr>
                            <th style="width: 100px">处置方式：</th>
                            <td class="tdr">
                                <input class="easyui-combobox" id="dealType" name="dealType"
                                       data-options="onlyview:true,editable:false" style="width: 100%;"/>
                            </td>
                        </tr>
                        <tr>
                            <th style="width: 100px">处置人：</th>
                            <td class="tdr">
                                <input class="easyui-textbox" id="dealUserName" name="dealUserName"
                                       data-options="onlyview:true,editable:false" style="width: 100%;"/>
                            </td>
                        </tr>
                        <tr>
                            <th style="width: 100px">处置日期：</th>
                            <td class="tdr">
                                <input class="easyui-datebox" id="dealDate" name="dealDate"
                                       data-options="onlyview:true,editable:false" style="width: 100%;"/>
                            </td>
                        </tr>
                        <tr>
                            <th style="width: 100px">处置备注：</th>
                            <td >
                                <textarea class="easyui-textbox " id="dealMemo" name="dealMemo" multiline="true"
                                          style="height:95px;width: 100%;border: 1px solid #ddd;border-radius: 5px;"
                                          data-options="onlyview:true,editable:false"></textarea>
                            </td>
                        </tr>
                    </table>
                </div>
                <div style="width:60%;height:98%;float: left">
                    <table class="table table-bordered table-info" style="width: 100%;height: 99%">
                        <tr>
                            <th style="width: 100px">处置原文：</th>
                            <td >
                                <textarea class="easyui-textbox " id="rawmsg" name="rawmsg" multiline="true"
                                          style="height:480px;width: 100%;border: 1px solid #ddd;border-radius: 5px;"
                                          data-options="onlyview:true,editable:false"></textarea>
                            </td>
                        </tr>
                    </table>
                </div>
            </form>
        </div>
    </div>
</div>
<script>
    var PAGE_DATA = {};
    var param = {};
    var operation;
    var pkid;
    var userId;
    var userName;
    var isFlow;
    var taskId;

    function i18nCallBack() {
        param = getParentParam_();
        userId = param.userId;
        userName = param.userName;
        isFlow = param.isFlow;
        taskId = param.taskId;
        if(!userId){
            var userInfo = getLoginInfo();
            userId = userInfo.userId;
            userName = userInfo.userName;
        }
        operation = param.operation;
        pkid = param.pkid;
        InitFuncCodeRequest_({
            data: {
                domainCode: "ENG_OIL_DEAL_TYPE",
                FunctionCode: "ANALYSIS_DOMAIN_BYCODE"
            },
            successCallBack: function (jdata) {
                if (jdata.code == RESULT_CODE.SUCCESS_CODE) {
                    $('#dealType').combobox({
                        panelHeight: '150px',
                        data: jdata.data.ENG_OIL_DEAL_TYPE,
                        multiple: true,
                        valueField: 'VALUE',
                        textField: 'TEXT'
                    });
                    if (pkid) {
                        InitDataForm(pkid);
                        getRes();
                    }

                } else {
                    MsgAlert({content: jdata.msg, type: 'error'});
                }
            }
        });
    }

    //回显
    function InitDataForm(pkid) {
        $('#pkid').val(pkid);
        InitGatewayRequest_({
            type: "get",
            async: false,
            path: "/meng-engine/engPerOver/selectById" + "/" + pkid,
            successCallBack: function (jdata) {
                if (jdata.success == true) {
                    if(jdata.obj && jdata.obj.rawmsg){
                        var myArray=new Array();
                        debugger;
                        var myArray = jdata.obj.rawmsg.trim().split(" ");
                        var reasonId;
                        var limitId;
                        var arrayList=[];
                        for (var i=0;i<myArray.length;i++)
                        {
                            if("LIMIT"==myArray[i]){
                                limitId = i;
                            }
                            if("S/N"==myArray[i]){
                                arrayList.push(i);
                            }

                            if("REASON"==myArray[i]){
                                reasonId = i;
                            }
                        }


                        var str_time= myArray[0]+" "+myArray[1]+"\n";
                        var str_t= myArray[2]+" "+myArray[3]+"\n";
                        var str_ti= myArray[4]+" "+myArray[5]+"\n";
                        var str_aa= myArray[6]+"\n";
                        var str_bb= myArray[7]+" "+myArray[8]+" "+myArray[9]+"\n";
                        var str_cc= myArray[10]+" "+myArray[11]+" "+myArray[12]+" "+myArray[13]+" "+myArray[14]+"\n";
                        var str_dd= myArray[15]+" "+myArray[16]+" "+myArray[17]+" "+myArray[18]+" "+myArray[19]+"\n";
                        var str_ee= myArray[20]+" "+myArray[21]+" "+myArray[22]+" "+myArray[23]+" "+myArray[24]+myArray[25]+" "+myArray[26]+"\n";
                        var str_ff= myArray[27]+" "+myArray[28]+" "+myArray[29]+""+myArray[30]+" "+myArray[31]+" "+myArray[32]+" "+myArray[33]+" "+myArray[34]+"\n";
                        var str_gg= myArray[35]+" "+myArray[36]+" "+myArray[37]+""+myArray[38]+"\n";
                        var str_hh= myArray[arrayList[0]];
                        var sn = arrayList[1] - arrayList[0];
                        for(var j = 1;j<sn;j++){
                            str_hh=str_hh+" "+myArray[arrayList[0]+j];
                        }
                        str_hh=str_hh+"\n"+myArray[arrayList[1]]+" "+myArray[arrayList[1]+1]+"\n\n";
                        var str_ii= myArray[43]+" "+myArray[44]+" "+myArray[45]+" "+myArray[46]+"\n";

                        var str_jj= myArray[47]+" "+myArray[48]+" "+myArray[49]+"\n";
                        var str_kk= myArray[50]+" "+myArray[51]+" "+myArray[52]+"\n";
                        var str_kk1=myArray[53]+" "+myArray[54]+" "+myArray[55]+"\n";
                        var str_kk2=myArray[56]+" "+myArray[57]+" "+myArray[58]+"\n";
                        var str_kk3= myArray[59]+" "+myArray[60]+" "+myArray[61]+"\n";
                        var str_kk4= myArray[62]+" "+myArray[63]+" "+myArray[64]+"\n";
                        var str_kk5= myArray[65]+" "+myArray[66]+" "+myArray[67]+"\n";
                        var str_kk6= myArray[68]+" "+myArray[69]+" "+myArray[70]+"\n";
                        var str_kk7= myArray[71]+" "+myArray[72]+" "+myArray[73]+"\n";
                        var str_kk8= myArray[74]+" "+myArray[75]+" "+ myArray[76]+"\n";
                        var str_kk9= myArray[77]+" "+myArray[78]+" "+myArray[79]+"\n";
                        var str_kk10= myArray[80]+" "+myArray[81]+" "+myArray[82]+"\n";
                        var str_kk11= myArray[83]+" "+myArray[84]+" "+myArray[85]+" "+myArray[86]+" "+myArray[87]+"\n";
                        var str_kk12 = myArray[88]+" "+myArray[89]+" "+myArray[90]+" "+myArray[91]+" "+myArray[92]+" "+ myArray[93]+ myArray[94]+" "+myArray[95]+" "+myArray[96]+" "+myArray[97]+" "+myArray[98]+"\n";
                        var str_kk13 = myArray[100]+" "+myArray[101]+" "+
                            myArray[102]+" "+myArray[103]+ myArray[104]+" "+myArray[105]+" "+myArray[106]+" "+myArray[107]+" "+myArray[108]+" "+myArray[109]+" "+myArray[110]+"\n";

                        var str_rr= myArray[111]+" "+
                            myArray[112]+" "+myArray[113]+" "+myArray[114]+" "+myArray[115]+" "+myArray[116]+" "+myArray[117]+" "+myArray[118]+myArray[119]+" "+myArray[120]+" "+"\n";
                        var str_ss= myArray[120]+" "+myArray[121]+" "+
                            myArray[122]+" "+myArray[123]+" "+myArray[124]+" "+myArray[125]+" "+myArray[126]+" "+myArray[127]+myArray[128]+" "+myArray[129]+" "+myArray[130]+"\n";
                        var str_tt= myArray[131]+" "+
                            myArray[132]+" "+myArray[133]+" "+myArray[134]+" "+myArray[135]+" "+myArray[136]+myArray[137]+" "+myArray[138]+" "+myArray[139]+" "+myArray[140]+"\n";
                        var str_a= myArray[140]+" "+myArray[141]+" "+
                            myArray[142]+" "+myArray[143]+" "+myArray[144]+" "+myArray[145]+" "+myArray[146]+" "+myArray[147]+" "+myArray[148]+" "+myArray[149]+" "+myArray[150]+"\n";
                        var str_b= myArray[151]
                            +myArray[152]+" "+myArray[153]+" "+myArray[154]+" "+myArray[155]+" "+myArray[156]+" "+myArray[157]+" "+
                            myArray[158]+" "+myArray[159]+" "+myArray[160]+" "+"\n";
                        var str_c= myArray[161]+" "+myArray[162]+" "+myArray[163]+" "+myArray[164]+" "+myArray[166]+" "+myArray[167]+" "+
                            myArray[168]+" "+myArray[169]+" "+myArray[170]+" "+"\n";
                        var str_d= myArray[171]+" "+myArray[172]+" "+myArray[173]+myArray[174]+" "+myArray[175]+" "+
                            myArray[176]+" "+myArray[177]+" "+myArray[178]+" "+myArray[179]+" "+myArray[180]+"\n";
                        var str_e= myArray[181]+" "+myArray[182]+" "+
                            myArray[183]+" "+myArray[184]+" "+myArray[185]+" "+myArray[186]+" "+myArray[187]+" "+myArray[188]+" "+myArray[189]+" "+myArray[190]+"\n";
                        var str_f= myArray[191]+" "+
                            myArray[192]+" "+myArray[193]+" "+myArray[194]+" "+myArray[195]+" "+myArray[196]+" "+myArray[197]+"\n";
                        var str_h= myArray[limitId]+" "+myArray[limitId+1]+" "+myArray[limitId+2]+ " "+myArray[limitId+3]+" "+
                            myArray[limitId+4]+" "+myArray[limitId+5]+" "+myArray[limitId+6]
                            +" "+myArray[limitId+7]+"\n";
                        var str_i= myArray[reasonId]+" "+myArray[reasonId+1]+"\n";

                        jdata.obj.rawmsg = str_time + str_t + str_ti
                        +str_aa+str_bb+str_cc+str_dd+"\n"
                        +str_ee+str_ff+str_gg+str_hh+str_ii
                            +str_jj+str_kk+str_kk1+str_kk2+str_kk3
                            +str_kk4+str_kk5+str_kk6
                            +str_kk7+str_kk8+str_kk9+str_kk10
                            +str_kk11+str_kk12+str_kk13+
                            str_rr+str_ss+str_tt
                            +str_a+str_b+str_c
                            +str_d+str_e+str_f
                            +str_h +str_i


                        ;
                    }
                    ParseFormField_(jdata.obj, $("#mform"));


                } else {
                    MsgAlert({content: '操作失败', type: 'error'});
                }
            }
        });
    }


</script>
</body>
</html>